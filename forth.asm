;
; BBC FORTH ROM DISASSEMBLY
;

; -----------------------------------------------------------------------------
;
;	MACROS
;
; -----------------------------------------------------------------------------

MACRO DEFENTRY flags%,name$
	EQUB	flags%+LEN(name$)
	IF LEN(name$)>1
	EQUB	MID$(name$,1,LEN(name$)-1)
	ENDIF
	EQUB	$80+ASC(RIGHT$(name$,1))
ENDMACRO

MACRO DEFWORD name$
	DEFENTRY	$80,name$
ENDMACRO

MACRO DEFIMM name$
	DEFENTRY	$C0,name$
ENDMACRO

; -----------------------------------------------------------------------------
;
;	FORTH CONFIGURATION FLAGS
;
; -----------------------------------------------------------------------------

KEEP_IN_ROM		=?	FALSE
REMOVE_UNREACHABLES	=?	FALSE

; -----------------------------------------------------------------------------

BOS	=	$10		; BOTTOM OF DATA STACK
TOS	=	$58		; TOP OF DATA STACK
N	=	$60		; SCRATCH WORKSPACE
XSAVE	=	$68		; TEMPORARY FOR X REGISTER
W	=	XSAVE+2		; CODE FIELD POINTER
IP	=	W+2		; INTERPRETIVE POINTER
UP	=	IP+2		; USER AREA POINTER

WBSIZ	=	1+255+2		; WORD BUFFER SIZE

UAREA	=	$400		; USER AREA
WORDBU	=	UAREA+64	; WORD BUFFER
TIBB	=	WORDBU+WBSIZ	; TERMINAL INPUT BUFFER
PADD	=	TIBB+126	; PAD
RAM	=	PADD+80		; RAM RELOCATION ADDR ($610)

EM	=	$7C00		; END OF MEMORY+1
BLKSIZ	=	1024
HDBT	=	BLKSIZ+4
NOBUF	=	2
BUFS	=	NOBUF*HDBT
BUF1	=	EM-BUFS		; FIRST BLOCK BUFFER

	ORG	$8000		; ROM ADDRESS

;	ROM HEADER

.L8000	JMP	L80D5		; LANGUAGE ENTRY
.L8003	JMP	L805F		; SERVICE ENTRY
.L8006	EQUB	$E2		; ROM TYPE
.L8007	EQUB	COPYR-L8000	; COPYRIGHT OFFSET
.L8008	EQUB	1		; BINARY VERSION NUMBER
.TITLE	EQUB	"FORTH"		; TITLE STRING
	EQUB	0
.VERS	EQUB	"1.03"		; VERSION STRING
.COPYR	EQUB	0,"(C)"		; COPYRIGHT IDENT
	EQUB	" Acornsoft Ltd. 1983"
	EQUB	0
	EQUW	L8000		; TUBE RELOC ADDRESS

	EQUW	0

.L8030	EQUB	$A,$D,"COLD or WARM start (C/W)? ",0
	EQUB	0

.L804E	LDA	#>L8000
	STA	$13
	LDY	#0
.L8054	LDA	($12),Y
	BEQ	L805E
	JSR	$FFEE
	INY
	BNE	L8054
.L805E	RTS

;	SERVICE ENTRY

.L805F	CMP	#4
	BNE	L80B0
	PHA
	TYA
	PHA
	LDA	($F2),Y
	CMP	#'F'
	BEQ	L8070
	CMP	#'f'
	BNE	L80AC
.L8070	INY
	LDA	($F2),Y
	CMP	#'O'
	BEQ	L807B
	CMP	#'o'
	BNE	L80A8

.L807B	INY
	LDA	($F2),Y
	CMP	#'R'
	BEQ	L8086
	CMP	#'r'
	BNE	L80A8
.L8086	INY
	LDA	($F2),Y
	CMP	#'T'
	BEQ	L8091
	CMP	#'t'
	BNE	L80A8
.L8091	INY
	LDA	($F2),Y
	CMP	#'H'
	BEQ	L809C
	CMP	#'h'
	BNE	L80A8
.L809C	INY
	LDA	($F2),Y
	CMP	#$D
	BNE	L80A8
	LDA	#$8E
	JMP	$FFF4

.L80A8	CMP	#'.'
	BEQ	L809C
.L80AC	PLA
	TAY
	PLA
	RTS

.L80B0	CMP	#9
	BEQ	L80B5
	RTS

.L80B5	PHA
	TYA
	PHA
	JSR	$FFE7
	LDA	#<TITLE
	STA	$12
	JSR	L804E
	LDA	#' '
	JSR	$FFEE
	LDA	#<VERS
	STA	$12
	JSR	L804E
	JSR	$FFE7
	PLA
	TAY
	PLA
	RTS

;	LANGUAGE ENTRY

.L80D5	CMP	#1
	BEQ	L80DA
	RTS

.L80DA	CLI
	LDA	#<L8030
	STA	$12
.L80DF	JSR	L804E
	JSR	$FFE0
	CMP	#$1B
	BNE	L80F0
	PHA
	LDA	#$7E
	JSR	$FFF4
	PLA
.L80F0	CMP	#'W'
	BEQ	L80FB
	CMP	#'C'
	BNE	L80DF
	JMP	L8102

.L80FB	JMP	L8105

	EQUB	$FF,$FF

	ORG	L8000+$100

ORIG	=	*		; FORTH ORIGIN

	NOP
	NOP
.L8102	JMP	COLD+2
.L8105	JMP	WARM+2

.L8108	EQUW	START+2
.L810A	EQUW	PABOR+2

; BOOT-UP LITERALS

.L810C	EQUW	TOPNFA		; TOP NFA
	EQUW	$7F		; BACKSPACE CHARACTER
.L8110	EQUW	UAREA		; INITIAL USER AREA
	EQUW	TOS		; INITIAL TOP OF STACK
	EQUW	$1FF		; INITIAL TOP OF RETURN STACK
	EQUW	TIBB		; INITIAL TERMINAL INPUT BUFFER
	EQUW	31		; INITIAL WIDTH
	EQUW	0		; INITIAL WARNING
	EQUW	TOPDP		; INITIAL FENCE
	EQUW	TOPDP		; INITIAL DP
	EQUW	VL0-REL		; INITIAL VOC-LINK
	EQUW	1

	EQUB	"RdeG-H"	; AUTHOR ?

.L812A	EQUW	L9501		; BRK HANDLER
.L812C	EQUW	ESCAPE+2	; ESCAPE HANDLER
.L812E	EQUW	OSERR+2		; OSERROR HANDLER

; -----------------------------------------------------------------------------
;
;	RESTART
;
; -----------------------------------------------------------------------------

.L8130	LDA	L8110+1		; RESET UP TO UAREA
	STA	UP+1
	LDA	L8110
	STA	UP
.L813A	LDA	L810C,Y		; INITIALISE USER VARIABLES
	STA	(UP),Y
	DEY
	BPL	L813A
	LDA	#$6C		; SET JMP (W) OPCODE
	STA	W-1
	CLD
	JMP	RPSTO+2		; RUN FORTH

; -----------------------------------------------------------------------------
;
;	LIT   ( ... n )
;
;	> Within a colon-definition, LIT is
;	> automatically compiled before each 16-bit literal
;	> number encountered in the input text. Later execution
;	> of LIT causes the contents of the following two bytes
;	> to be pushed onto the stack.
;
; -----------------------------------------------------------------------------

.L814A	DEFWORD	"LIT"
	EQUW	0		; FIRST WORD IN DICTIONARY
.LIT	EQUW	*+2
	LDA	(IP),Y		; LOAD LO BYTE OF LITERAL
	PHA			; PUSH ONTO STACK
	INC	IP		; INCREMENT IP
	BNE	L815B
	INC	IP+1
.L815B	LDA	(IP),Y		; LOAD HI BYTE OF LITERAL
	INC	IP		; INCREMENT IP
	BNE	PUSH		; PUSH LITERAL ONTO DATA STACK
	INC	IP+1

.PUSH	DEX			; MAKE ROOM ON DATA STACK FOR
	DEX			; 16-BIT VALUE

.PUT	STA	1,X		; STORE 16-BIT VALUE FROM A AND
	PLA			; RETURN STACK ONTO DATA STACK
	STA	0,X

.NEXT	LDY	#1		; FETCH HI BYTE OF CFA
.L816C	LDA	(IP),Y
	STA	W+1		; STORE IN W
	DEY
	LDA	(IP),Y		; FETCH LO BYTE OF CFA
	STA	W		; STORE IN W
	CLC
	LDA	IP		; ADVANCE IP TO NEXT CFA
	ADC	#2
	STA	IP
	BCC	L8180
	INC	IP+1
.L8180	BIT	$FF		; TEST FOR ESCAPE PRESSED
	BMI	L8187
	JMP	W-1		; EXECUTE (CFA)

.L8187	JMP	L94ED		; ESCAPE PRESSED

.SETUP	ASL	A
	STA	$5F
.L818D	LDA	0,X
	STA	N,Y
	INX
	INY
	CPY	$5F
	BNE	L818D
	LDY	#0
	RTS

;	EXECUTE

.L819B	DEFWORD	"EXECUTE"
	EQUW	L814A
.EXEC	EQUW	*+2
	LDA	0,X
	STA	W
	LDA	1,X
	STA	W+1
	INX
	INX
	JMP	W-1

;	@EXECUTE

.L81B4	DEFWORD	"@EXECUTE"
	EQUW	L819B
.ATEXEC	EQUW	*+2
	LDA	(0,X)
	STA	W
	INC	0,X
	BNE	L81CB
	INC	1,X
.L81CB	LDA	(0,X)
	STA	W+1
	INX
	INX
	JMP	W-1

;	BRANCH

.L81D4	DEFWORD	"BRANCH"
	EQUW	L81B4
.BRAN	EQUW	L81E1

.L81DF	LDX	XSAVE
.L81E1	CLC
	LDA	(IP),Y
	ADC	IP
	PHA
	INY
	LDA	(IP),Y
	ADC	IP+1
	STA	IP+1
	PLA
	STA	IP
	JMP	L816C

;	0BRANCH

.L81F4	DEFWORD	"0BRANCH"
	EQUW	L81D4
.ZBRAN	EQUW	*+2
	INX
	INX
	LDA	$FE,X
	ORA	$FF,X
	BEQ	L81E1
.BUMP	CLC
	LDA	IP
	ADC	#2
	STA	IP
	BCC	L8213
	INC	IP+1
.L8213	JMP	NEXT

;	(LOOP)

.L8216	DEFWORD	"(LOOP)"
	EQUW	L81F4
.XLOOP	EQUW	*+2
	STX	XSAVE
	TSX
	INC	$101,X
	BNE	L8233
	TYA
	SEC
	ADC	$102,X
	BVS	L8246
	STA	$102,X
.L8233	CLC
	LDA	$103,X
	SBC	$101,X
	LDA	$104,X
	SBC	$102,X
	BVC	L8244
	EOR	#$80
.L8244	BPL	L81DF

.L8246	LDX	XSAVE
	PLA
	PLA
	PLA
	PLA
	JMP	BUMP

;	(+LOOP)

.L824F	DEFWORD	"(+LOOP)"
	EQUW	L8216
.XPLOO	EQUW	*+2
	LDA	1,X
	PHA
	PHA
	LDA	0,X
	INX
	INX
	STX	XSAVE
	TSX
	INX
	INX
	CLC
	ADC	$101,X
	STA	$101,X
	PLA
	ADC	$102,X
	STA	$102,X
	PLA
	BVS	L8246
	BPL	L8233
	SEC
	LDA	$101,X
	SBC	$103,X
	LDA	$102,X
	SBC	$104,X
	BVS	L8246
	BVC	L8244

;	(ULOOP)

.L828C	DEFWORD	"(ULOOP)"
	EQUW	L824F
.XPULO	EQUW	*+2
	STX	XSAVE
	TSX
	INC	$101,X
	BNE	L82A3
	INC	$102,X
.L82A3	CLC
	LDA	$103,X
	SBC	$101,X
	LDA	$104,X
	SBC	$102,X
	JMP	L8244

;	I

.L82B3	DEFWORD	"I"
	EQUW	L828C
.IDO	EQUW	*+2
	STX	XSAVE
	TSX
	LDA	$101,X
	PHA
	LDA	$102,X
	LDX	XSAVE
	JMP	PUSH

;	(DO)

.L82C8	DEFWORD	"(DO)"
	EQUW	L82B3
.XDO	EQUW	*+2
	LDA	3,X
	PHA
	LDA	2,X
	PHA
	LDA	1,X
	PHA
	LDA	0,X
	PHA

.POPTWO	INX
	INX

.POP	INX
	INX
	JMP	NEXT

;	HIADDR

.L82E4	DEFWORD	"HIADDR"
	EQUW	L82C8
.HIADR	EQUW	*+2
	STX	XSAVE
	LDA	#$82
	JSR	$FFF4
	TXA
	LDX	XSAVE
	PHA
	TYA
	JMP	PUSH

;	MODEADDR

.L82FE	DEFWORD	"MODEADDR"
	EQUW	L82E4
.MODADR	EQUW	*+2
	STX	XSAVE
	LDA	0,X
	TAX
	LDA	#$85
	JSR	$FFF4
	TXA
	LDX	XSAVE
	STY	1,X
	STA	0,X
	JMP	NEXT

;	DIGIT

.L831F	DEFWORD	"DIGIT"
	EQUW	L82FE
.DIGIT	EQUW	*+2
	SEC
	LDA	2,X
	SBC	#'0'
	BMI	L8348
	CMP	#$A
	BMI	L833B
	SEC
	SBC	#7
	CMP	#$A
	BMI	L8348
.L833B	CMP	0,X
	BPL	L8348
	STA	2,X
	LDA	#1
	PHA
	TYA
	JMP	PUT

.L8348	TYA
	PHA
	INX
	INX
	JMP	PUT

;	(FIND)

.L834F	DEFWORD	"(FIND)"
	EQUW	L831F
.PFIND	EQUW	*+2
	LDA	#2
	JSR	SETUP
	STX	XSAVE
.L8361	LDY	#0
	LDA	(N),Y
	EOR	(N+2),Y
	AND	#$3F
	BNE	L8398
.L836B	INY
	LDA	(N),Y
	EOR	(N+2),Y
	ASL	A
	BNE	L8396
	BCC	L836B
	LDX	XSAVE
	DEX
	DEX
	DEX
	DEX
	CLC
	TYA
	ADC	#3
	ADC	N
	STA	2,X
	LDY	#0
	TYA
	ADC	N+1
	STA	3,X
	STY	1,X
	LDA	(N),Y
	STA	0,X
	LDA	#1
	PHA
	JMP	PUSH

.L8396	BCS	L839D
.L8398	INY
	LDA	(N),Y
	BPL	L8398
.L839D	INY
	LDA	(N),Y
	TAX
	INY
	LDA	(N),Y
	STA	N+1
	STX	N
	ORA	N
	BNE	L8361
	LDX	XSAVE
	LDA	#0
	PHA
	JMP	PUSH

;	ENCLOSE

.L83B4	DEFWORD	"ENCLOSE"
	EQUW	L834F
.ENCL	EQUW	*+2
	LDA	#2
	JSR	SETUP
	TXA
	SEC
	SBC	#8
	TAX
	DEY
	STY	N+1
	DEC	N+3
.L83CF	INY
	BNE	L83D6
	INC	N+1
	INC	N+3
.L83D6	LDA	(N+2),Y
	CMP	N
	BEQ	L83CF
	STY	4,X
	LDA	N+1
	STA	5,X
.L83E2	LDA	(N+2),Y
	BNE	L8404
	STY	2,X
	STY	0,X
	LDA	N+1
	STA	3,X
	STA	1,X
	TYA
	CMP	4,X
	BNE	L8401
	LDA	N+1
	CMP	5,X
	BNE	L8401
	INC	2,X
	BNE	L8401
	INC	3,X
.L8401	JMP	NEXT

.L8404	INY
	BNE	L840B
.L8407	INC	N+3
	INC	N+1
.L840B	CMP	N
	BNE	L83E2
	STY	0,X
	LDA	N+1
	STA	1,X
	STA	3,X
	TYA
	BNE	L841C
	DEC	3,X
.L841C	DEY
	STY	2,X
	JMP	NEXT

;	SP@

.L8422	DEFWORD	"SP@"
	EQUW	L83B4
.SPAT	EQUW	*+2
	TXA
.L842B	PHA
	LDA	#0
	JMP	PUSH

;	RP@

.L8431	DEFWORD	"RP@"
	EQUW	L8422
.RPAT	EQUW	*+2
	STX	XSAVE
	TSX
	TXA
	LDX	XSAVE
	PHA
	LDA	#1
	JMP	PUSH

;	SP!

.L8445	DEFWORD	"SP!"
	EQUW	L8431
.SPSTO	EQUW	*+2
	LDY	#6
	LDA	(UP),Y
	TAX
	JMP	NEXT

;	RP!

.L8455	DEFWORD	"RP!"
	EQUW	L8445
.RPSTO	EQUW	*+2
	STX	XSAVE
	LDY	#8
	LDA	(UP),Y
	TAX
	TXS
.L8465	LDX	XSAVE
	JMP	NEXT

;	(EMIT)

.L846A	DEFWORD	"(EMIT)"
	EQUW	L8455
.PEMIT	EQUW	*+2
	TYA
	SEC
	LDY	#$1A
	ADC	(UP),Y
	STA	(UP),Y
	INY
	LDA	#0
	ADC	(UP),Y
	STA	(UP),Y
	LDA	0,X
	AND	#$7F
	JSR	$FFEE
	JMP	POP

;	>VDU

.L848E	DEFWORD	">VDU"
	EQUW	L9FFB-REL
.TOVDU	EQUW	*+2
	LDA	0,X
	JSR	$FFEE
	JMP	POP

;	CMOVE

.L849F	DEFWORD	"CMOVE"
	EQUW	L848E
.CMOVE	EQUW	*+2
	SEC
	TYA
	SBC	0,X
	TYA
	SBC	1,X
	BPL	L84D0
	LDA	#3
	JSR	SETUP
.L84B7	CPY	N
	BNE	L84C2
	DEC	N+1
	BPL	L84C2
	JMP	NEXT

.L84C2	LDA	(N+4),Y
	STA	(N+2),Y
	INY
	BNE	L84B7
	INC	N+5
	INC	N+3
	JMP	L84B7

.L84D0	INX
	INX
	JMP	POPTWO

;	U*

.L84D5	DEFWORD	"U*"
	EQUW	L849F
.USTAR	EQUW	*+2
	LDA	0,X
	STA	N
	LDA	1,X
	STA	N+1
	TYA
	STA	0,X
	CLC
	LDY	#$11
	BNE	L84F9

.L84EC	BCC	L84F9
	PHA
	CLC
	LDA	0,X
	ADC	N
	STA	0,X
	PLA
	ADC	N+1
.L84F9	ROR	A
	ROR	0,X
	ROR	3,X
	ROR	2,X
	DEY
	BNE	L84EC
	STA	1,X
	JMP	NEXT

;	U/

.L8508	DEFWORD	"U/"
	EQUW	L84D5
.USLAS	EQUW	*+2
	STY	N+1
	LDA	4,X
	LDY	2,X
	STY	4,X
	ASL	A
	STA	2,X
	LDA	5,X
	LDY	3,X
	STY	5,X
	ROL	A
	STA	3,X
	LDA	#$10
	STA	N
.L8527	ROL	4,X
	ROL	5,X
	ROL	N+1
	SEC
	LDA	4,X
	SBC	0,X
	TAY
	LDA	5,X
	SBC	1,X
	PHA
	LDA	N+1
	SBC	#0
	PLA
	BCC	L8543
	STY	4,X
	STA	5,X
.L8543	ROL	2,X
	ROL	3,X
	DEC	N
	BNE	L8527
	JMP	POP

;	AND

.L854E	DEFWORD	"AND"
	EQUW	L8508
.ANDD	EQUW	*+2
	LDA	0,X
	AND	2,X
	PHA
	LDA	1,X
	AND	3,X
	INX
	INX
	JMP	PUT

;	OR

.L8564	DEFWORD	"OR"
	EQUW	L854E
.ORR	EQUW	*+2
	LDA	0,X
	ORA	2,X
	PHA
	LDA	1,X
	ORA	3,X
	INX
	INX
	JMP	PUT

;	XOR

.L8579	DEFWORD	"XOR"
	EQUW	L8564
.XORR	EQUW	*+2
	LDA	0,X
	EOR	2,X
	PHA
	LDA	1,X
	EOR	3,X
	INX
	INX
	JMP	PUT

;	?KEY

.L858F	DEFWORD	"?KEY"
	EQUW	L8579
.QKEY	EQUW	*+2
	STX	XSAVE
	LDX	#1
	LDA	#$C
	JSR	$FFF4
	STX	N
	LDX	#0
	LDA	#$B
	JSR	$FFF4
	STX	N+1
	LDX	#1
	LDA	#$F
	JSR	$FFF4
	LDX	XSAVE
	LDY	1,X
	LDA	0,X
	TAX
	LDA	#$81
	JSR	$FFF4
	TXA
	PHA
	TYA
	PHA
	LDX	N
	LDA	#$C
	JSR	$FFF4
	LDX	N+1
	LDA	#$B
	JSR	$FFF4
	PLA
	LDX	XSAVE
	JMP	PUT

;	(KEY)

.L85D7	DEFWORD	"(KEY)"
	EQUW	L858F
.PKEY	EQUW	*+2
	JSR	$FFE0
	JMP	L842B

; -----------------------------------------------------------------------------
;
;	EXIT   ( ... )
;
;	> When compiled within a colon-definition,
;	> terminates execution of the definition at that point.
;	> It may not be used within a DO ... LOOP . It is also
;	> used to terminate the interpretation of mass storage.
;
; -----------------------------------------------------------------------------

.L85E7	DEFWORD	"EXIT"
	EQUW	LA006-REL
.EXIT	EQUW	*+2
	PLA
	STA	IP
	PLA
	STA	IP+1
	JMP	NEXT

;	R@

.L85F9	DEFWORD	"R@"
	EQUW	L85E7
.RAT	EQUW	*+2
	STX	XSAVE
	TSX
	LDA	$101,X
	PHA
	LDA	$102,X
	LDX	XSAVE
	JMP	PUSH

;	>R

.L860F	DEFWORD	">R"
	EQUW	L85F9
.TOR	EQUW	*+2
	LDA	1,X
	PHA
	LDA	0,X
	PHA
	JMP	POP

;	R>

.L861F	DEFWORD	"R>"
	EQUW	L860F
.RFROM	EQUW	*+2
	DEX
	DEX
	PLA
	STA	0,X
	PLA
	STA	1,X
	JMP	NEXT

;	><

.L8631	DEFWORD	"><"
	EQUW	L861F
.BSWAP	EQUW	*+2
	LDY	0,X
	LDA	1,X
	STA	0,X
	STY	1,X
	JMP	NEXT

;	LEAVE

.L8643	DEFWORD	"LEAVE"
	EQUW	L8631
.LEAV	EQUW	*+2
	STX	XSAVE
	TSX
	LDA	$101,X
	STA	$103,X
	LDA	$102,X
	STA	$104,X
	LDX	XSAVE
	JMP	NEXT

;	0=

.L8661	DEFWORD	"0="
	EQUW	L8643
.ZEQU	EQUW	*+2
	LDA	0,X
	ORA	1,X
	STY	1,X
	BNE	L8671
	INY
.L8671	STY	0,X
	JMP	NEXT

;	0<

.L8676	DEFWORD	"0<"
	EQUW	L8661
.ZLESS	EQUW	*+2
	ASL	1,X
	TYA
	ROL	A
	STY	1,X
	STA	0,X
	JMP	NEXT

;	<

.L8688	DEFWORD	"<"
	EQUW	L8676
.LESS	EQUW	*+2
	SEC
	LDA	2,X
	SBC	0,X
	LDA	3,X
	SBC	1,X
	STY	3,X
	BVC	L869D
	EOR	#$80
.L869D	BPL	L86A0
	INY
.L86A0	STY	2,X
	JMP	POP

;	D<

.L86A5	DEFWORD	"D<"
	EQUW	L8688
.DLESS	EQUW	*+2
	SEC
	LDA	6,X
	SBC	2,X
	LDA	7,X
	SBC	3,X
	LDA	4,X
	SBC	0,X
	LDA	5,X
	SBC	1,X
	BVC	L86C1
	EOR	#$80
.L86C1	BPL	L86C4
	INY
.L86C4	TYA
	LDY	#4
.L86C7	INX
	INX
	DEY
	BNE	L86C7
	JMP	L842B

;	+

.L86CF	DEFWORD	"+"
	EQUW	L86A5
.PLUS	EQUW	*+2
	CLC
	LDA	0,X
	ADC	2,X
	STA	2,X
	LDA	1,X
	ADC	3,X
	STA	3,X
	JMP	POP

;	D+

.L86E5	DEFWORD	"D+"
	EQUW	L86CF
.DPLUS	EQUW	*+2
	CLC
	LDA	2,X
	ADC	6,X
	STA	6,X
	LDA	3,X
	ADC	7,X
	STA	7,X
	LDA	0,X
	ADC	4,X
	STA	4,X
	LDA	1,X
	ADC	5,X
	STA	5,X
	JMP	POPTWO

;	NEGATE

.L8708	DEFWORD	"NEGATE"
	EQUW	L86E5
.NEGAT	EQUW	*+2
	SEC
.L8714	TYA
	SBC	0,X
	STA	0,X
	TYA
	SBC	1,X
	STA	1,X
	JMP	NEXT

;	DNEGATE

.L8721	DEFWORD	"DNEGATE"
	EQUW	L8708
.DNEGAT	EQUW	*+2
	SEC
	TYA
	SBC	2,X
	STA	2,X
	TYA
	SBC	3,X
	STA	3,X
	JMP	L8714

;	DROP

.L873B	DEFWORD	"DROP"
	EQUW	L8721
.DROP	EQUW	POP

;	2DROP

.L8744	DEFWORD	"2DROP"
	EQUW	L873B
.TDROP	EQUW	POPTWO

;	DUP

.L874E	DEFWORD	"DUP"
	EQUW	L8744
.DUPP	EQUW	*+2
	LDA	0,X
	PHA
	LDA	1,X
	JMP	PUSH

;	?DUP

.L875E	DEFWORD	"?DUP"
	EQUW	L874E
.QDUP	EQUW	*+2
	LDA	0,X
	ORA	1,X
	BNE	DUPP+2
	JMP	NEXT

;	2DUP

.L8770	DEFWORD	"2DUP"
	EQUW	L875E
.TDUP	EQUW	*+2
	LDA	0,X
	PHA
	LDA	1,X
	PHA
	LDA	2,X
	PHA
	LDA	3,X
	DEX
	DEX
	STA	1,X
	PLA
	STA	0,X
	PLA
	JMP	PUSH

;	SWAP

.L878F	DEFWORD	"SWAP"
	EQUW	L8770
.SWAP	EQUW	*+2
	LDA	2,X
	PHA
	LDA	0,X
	STA	2,X
	LDA	3,X
	LDY	1,X
	STY	3,X
	JMP	PUT

;	2SWAP

.L87A8	DEFWORD	"2SWAP"
	EQUW	L878F
.TSWAP	EQUW	*+2
	LDY	6,X
	LDA	2,X
	STA	6,X
	STY	2,X
	LDY	7,X
	LDA	3,X
	STA	7,X
	STY	3,X
	LDA	4,X
	PHA
	LDA	0,X
	STA	4,X
	LDA	5,X
	LDY	1,X
	STY	5,X
	JMP	PUT

;	OVER

.L87D2	DEFWORD	"OVER"
	EQUW	L87A8
.OVER	EQUW	*+2
	LDA	2,X
	PHA
	LDA	3,X
	JMP	PUSH

;	2OVER

.L87E3	DEFWORD	"2OVER"
	EQUW	L87D2
.TOVER	EQUW	*+2
	LDA	4,X
	PHA
	LDA	5,X
	DEX
	DEX
	LDY	9,X
	STY	1,X
	LDY	8,X
	STY	0,X
	JMP	PUSH

;	ROT

.L87FF	DEFWORD	"ROT"
	EQUW	L87E3
.ROT	EQUW	*+2
	LDA	4,X
	PHA
	LDY	5,X
	LDA	3,X
	STA	5,X
	LDA	2,X
	STA	4,X
	LDA	1,X
	STA	3,X
	LDA	0,X
	STA	2,X
	TYA
	JMP	PUT

;	TRAVERSE

.L8820	DEFWORD	"TRAVERSE"
	EQUW	L87FF
.TRAV	EQUW	*+2
	CLC
	LDA	0,X
	ADC	2,X
	STA	2,X
	LDA	1,X
	ADC	3,X
	STA	3,X
	LDA	(2,X)
	CMP	#$80
	BMI	TRAV+2
	JMP	POP

;	PAGE

.L8843	DEFWORD	"PAGE"
	EQUW	L8820
.PAGE	EQUW	*+2
	STX	XSAVE
	LDA	#$83
	JSR	$FFF4
	TXA
	PHA
	TYA
	LDX	XSAVE
	JMP	PUSH

;	HIMEM

.L885B	DEFWORD	"HIMEM"
	EQUW	L8843
.HIMEM	EQUW	*+2
	STX	XSAVE
	LDA	#$84
	JSR	$FFF4
	TXA
	PHA
	TYA
	LDX	XSAVE
	JMP	PUSH

;	?FILE

.L8874	DEFWORD	"?FILE"
	EQUW	L885B
.QFILE	EQUW	*+2
	TYA
	JSR	$FFDA
	JMP	L842B

;	C@

.L8885	DEFWORD	"C@"
	EQUW	L8874
.CAT	EQUW	*+2
	LDA	(0,X)
	STA	0,X
	STY	1,X
	JMP	NEXT

;	@

.L8895	DEFWORD	"@"
	EQUW	L8885
.AT	EQUW	*+2
	LDA	(0,X)
	PHA
	INC	0,X
	BNE	L88A4
	INC	1,X
.L88A4	LDA	(0,X)
	JMP	PUT

;	C!

.L88A9	DEFWORD	"C!"
	EQUW	L8895
.CSTOR	EQUW	*+2
	LDA	2,X
	STA	(0,X)
	JMP	POPTWO

;	!

.L88B7	DEFWORD	"!"
	EQUW	L88A9
.STORE	EQUW	*+2
	LDA	2,X
	STA	(0,X)
	INC	0,X
	BNE	L88C7
	INC	1,X
.L88C7	LDA	3,X
	STA	(0,X)
	JMP	POPTWO

;	+!

.L88CE	DEFWORD	"+!"
	EQUW	L88B7
.PSTOR	EQUW	*+2
	CLC
	LDA	(0,X)
	ADC	2,X
	STA	(0,X)
	INC	0,X
	BNE	L88E2
	INC	1,X
.L88E2	LDA	(0,X)
	ADC	3,X
	STA	(0,X)
	JMP	POPTWO

;	TOGGLE

.L88EB	DEFWORD	"TOGGLE"
	EQUW	L88CE
.TOGGL	EQUW	*+2
	LDA	(2,X)
	EOR	0,X
	STA	(2,X)
	JMP	POPTWO

;	R:

.L88FF	DEFWORD	"R:"
	EQUW	L88EB
.RCOLON	EQUW	DOCOL
	EQUW	QEXEC
	EQUW	SCSP
	EQUW	CURR
	EQUW	AT
	EQUW	CONT
	EQUW	STORE
	EQUW	CREAT
	EQUW	RBRAC
	EQUW	PSCOD
.DOCOL	LDA	IP+1
	PHA
	LDA	IP
	PHA
	CLC
	LDA	W
	ADC	#2
	STA	IP
	TYA
	ADC	W+1
	STA	IP+1
	JMP	NEXT

;	R;

.L892D	DEFIMM	"R;"
	EQUW	L88FF
.RSEMI	EQUW	DOCOL
	EQUW	QCSP
	EQUW	COMP
	EQUW	EXIT
	EQUW	LBRAC
	EQUW	EXIT

;	CONSTANT

.L893E	DEFWORD	"CONSTANT"
	EQUW	L892D
.CONST	EQUW	DOCOL
	EQUW	CREAT
	EQUW	COMMA
	EQUW	PSCOD
.DOCON	LDY	#2
	LDA	(W),Y
	PHA
	INY
	LDA	(W),Y
	JMP	PUSH

;	VARIABLE

.L895C	DEFWORD	"VARIABLE"
	EQUW	L893E
.VAR	EQUW	DOCOL
	EQUW	CREAT
	EQUW	ZERO
	EQUW	COMMA
	EQUW	PSCOD
.DOVAR	CLC
	LDA	W
	ADC	#2
	PHA
	TYA
	ADC	W+1
	JMP	PUSH

;	USER

.L897D	DEFWORD	"USER"
	EQUW	L895C
.USER	EQUW	DOCOL
	EQUW	CONST
	EQUW	PSCOD
.DOUSE	LDY	#2
	CLC
	LDA	(W),Y
	ADC	UP
	PHA
	LDA	#0
	ADC	UP+1
	JMP	PUSH

;	-2

.L8999	DEFWORD	"-2"
	EQUW	L897D
.NEGTWO	EQUW	DOCON
	EQUW	-2

;	-1

.L89A2	DEFWORD	"-1"
	EQUW	L8999
.MIN1	EQUW	DOCON
	EQUW	-1

;	0

.L89AB	DEFWORD	"0"
	EQUW	L89A2
.ZERO	EQUW	DOCON
	EQUW	0

;	1

.L89B3	DEFWORD	"1"
	EQUW	L89AB
.ONE	EQUW	DOCON
	EQUW	1

;	2

.L89BB	DEFWORD	"2"
	EQUW	L89B3
.TWO	EQUW	DOCON
	EQUW	2

;	BL

.L89C3	DEFWORD	"BL"
	EQUW	L89BB
.BLL	EQUW	DOCON
	EQUW	$20

;	C/L

.L89CC	DEFWORD	"C/L"
	EQUW	L89C3
.CSLL	EQUW	DOCON
	EQUW	64

;	PAD

.L89D6	DEFWORD	"PAD"
	EQUW	L89CC
.PAD	EQUW	DOCON
	EQUW	PADD

;	B/BUF

.L89E0	DEFWORD	"B/BUF"
	EQUW	LA01C-REL
.BBUF	EQUW	DOCON
	EQUW	BLKSIZ

;	B/SCR

.L89EC	DEFWORD	"B/SCR"
	EQUW	L89E0
.BSCR	EQUW	DOCON
	EQUW	1

;	+ORIGIN

.L89F8	DEFWORD	"+ORIGIN"
	EQUW	L89EC
.PORIG	EQUW	DOCOL
	EQUW	LIT,ORIG
	EQUW	PLUS
	EQUW	EXIT

;	S0

.L8A0C	DEFWORD	"S0"
	EQUW	L89F8
.SZERO	EQUW	DOUSE
	EQUB	6

;	R0

.L8A14	DEFWORD	"R0"
	EQUW	L8A0C
.RZERO	EQUW	DOUSE
	EQUB	8

;	TIB

.L8A1C	DEFWORD	"TIB"
	EQUW	L8A14
.TIB	EQUW	DOUSE
	EQUB	$A

;	WIDTH

.L8A25	DEFWORD	"WIDTH"
	EQUW	L8A1C
.WIDTH	EQUW	DOUSE
	EQUB	$C

;	WARNING

.L8A30	DEFWORD	"WARNING"
	EQUW	L8A25
.WARN	EQUW	DOUSE
	EQUB	$E

;	FENCE

.L8A3D	DEFWORD	"FENCE"
	EQUW	L8A30
.FENCE	EQUW	DOUSE
	EQUB	$10

;	DP

.L8A48	DEFWORD	"DP"
	EQUW	L8A3D
.DP	EQUW	DOUSE
	EQUB	$12

;	VOC-LINK

.L8A50	DEFWORD	"VOC-LINK"
	EQUW	L8A48
.VOCL	EQUW	DOUSE
	EQUB	$14

;	BLK

.L8A5E	DEFWORD	"BLK"
	EQUW	L8A50
.BLK	EQUW	DOUSE
	EQUB	$16

;	>IN

.L8A67	DEFWORD	">IN"
	EQUW	L8A5E
.INN	EQUW	DOUSE
	EQUB	$18

;	OUT

.L8A70	DEFWORD	"OUT"
	EQUW	L8A67
.OUT	EQUW	DOUSE
	EQUB	$1A

;	SCR

.L8A79	DEFWORD	"SCR"
	EQUW	L8A70
.SCR	EQUW	DOUSE
	EQUB	$1C

;	OFFSET

.L8A82	DEFWORD	"OFFSET"
	EQUW	L8A79
.OFFSE	EQUW	DOUSE
	EQUB	$1E

;	CONTEXT

.L8A8E	DEFWORD	"CONTEXT"
	EQUW	L8A82
.CONT	EQUW	DOUSE
	EQUB	$20

;	CURRENT

.L8A9B	DEFWORD	"CURRENT"
	EQUW	L8A8E
.CURR	EQUW	DOUSE
	EQUB	$22

;	STATE

.L8AA8	DEFWORD	"STATE"
	EQUW	L8A9B
.STATE	EQUW	DOUSE
	EQUB	$24

;	BASE

.L8AB3	DEFWORD	"BASE"
	EQUW	L8AA8
.BASE	EQUW	DOUSE
	EQUB	$26

;	DPL

.L8ABD	DEFWORD	"DPL"
	EQUW	L8AB3
.DPL	EQUW	DOUSE
	EQUB	$28

;	CSP

.L8AC6	DEFWORD	"CSP"
	EQUW	L8ABD
.CSP	EQUW	DOUSE
	EQUB	$2C

;	R#

.L8ACF	DEFWORD	"R#"
	EQUW	L8AC6
.RNUM	EQUW	DOUSE
	EQUB	$2E

;	HLD

.L8AD7	DEFWORD	"HLD"
	EQUW	L8ACF
.HLD	EQUW	DOUSE
	EQUB	$30

;	1+

.L8AE0	DEFWORD	"1+"
	EQUW	L8AD7
.ONEP	EQUW	DOCOL
	EQUW	ONE
	EQUW	PLUS
	EQUW	EXIT

;	2+

.L8AED	DEFWORD	"2+"
	EQUW	L8AE0
.TWOP	EQUW	DOCOL
	EQUW	TWO
	EQUW	PLUS
	EQUW	EXIT

	EQUB	0

;	1-

.L8AFB	DEFWORD	"1-"
	EQUW	L8AED
.ONESUB	EQUW	DOCOL
	EQUW	MIN1
	EQUW	PLUS
	EQUW	EXIT

;	2-

.L8B08	DEFWORD	"2-"
	EQUW	L8AFB
.TWOSUB	EQUW	DOCOL
	EQUW	NEGTWO
	EQUW	PLUS
	EQUW	EXIT

;	HERE

.L8B15	DEFWORD	"HERE"
	EQUW	L8B08
.HERE	EQUW	DOCOL
	EQUW	DP
	EQUW	AT
	EQUW	EXIT

;	ALLOT

.L8B24	DEFWORD	"ALLOT"
	EQUW	L8B15
.ALLOT	EQUW	DOCOL
	EQUW	DP
	EQUW	PSTOR
	EQUW	EXIT

;	SPACE

.L8B34	DEFWORD	"SPACE"
	EQUW	L8B24
.SPACE	EQUW	DOCOL
	EQUW	BLL
	EQUW	EMIT
	EQUW	EXIT

;	,

.L8B44	DEFWORD	","
	EQUW	L8B34
.COMMA	EQUW	DOCOL
	EQUW	HERE
	EQUW	STORE
	EQUW	TWO
	EQUW	ALLOT
	EQUW	EXIT

;	C,

.L8B54	DEFWORD	"C,"
	EQUW	L8B44
.CCOMM	EQUW	DOCOL
	EQUW	HERE
	EQUW	CSTOR
	EQUW	ONE
	EQUW	ALLOT
	EQUW	EXIT

;	LAST

.L8B65	DEFWORD	"LAST"
	EQUW	L8B54
.LAST	EQUW	DOCOL
	EQUW	CURR
	EQUW	AT
	EQUW	AT
	EQUW	EXIT

;	SMUDGE

.L8B76	DEFWORD	"SMUDGE"
	EQUW	L8B65
.SMUDG	EQUW	DOCOL
	EQUW	LAST
	EQUW	LIT,$20
	EQUW	TOGGL
	EQUW	EXIT

;	-

.L8B8B	DEFWORD	"-"
	EQUW	L8B76
.SUBB	EQUW	DOCOL
	EQUW	NEGAT
	EQUW	PLUS
	EQUW	EXIT

;	=

.L8B97	DEFWORD	"="
	EQUW	L8B8B
.EQUAL	EQUW	DOCOL
	EQUW	SUBB
	EQUW	ZEQU
	EQUW	EXIT

;	>

.L8BA3	DEFWORD	">"
	EQUW	L8B97
.GREAT	EQUW	DOCOL
	EQUW	SWAP
	EQUW	LESS
	EQUW	EXIT

;	U<

.L8BAF	DEFWORD	"U<"
	EQUW	L8BA3
.ULESS	EQUW	DOCOL
	EQUW	ZERO
	EQUW	SWAP
	EQUW	ZERO
	EQUW	DLESS
	EQUW	EXIT

;	LFA

.L8BC0	DEFWORD	"LFA"
	EQUW	L8BAF
.LFA	EQUW	DOCOL
	EQUW	LIT,4
	EQUW	SUBB
	EQUW	EXIT

;	NFA

.L8BD0	DEFWORD	"NFA"
	EQUW	L8BC0
.NFA	EQUW	DOCOL
	EQUW	LIT,5
	EQUW	SUBB
	EQUW	MIN1
	EQUW	TRAV
	EQUW	EXIT

;	CFA

.L8BE4	DEFWORD	"CFA"
	EQUW	L8BD0
.CFA	EQUW	DOCOL
	EQUW	TWOSUB
	EQUW	EXIT

;	PFA

.L8BF0	DEFWORD	"PFA"
	EQUW	L8BE4
.PFA	EQUW	DOCOL
	EQUW	ONE
	EQUW	TRAV
	EQUW	LIT,5
	EQUW	PLUS
	EQUW	EXIT

;	NOT

.L8C04	DEFWORD	"NOT"
	EQUW	L8BF0
.NOT	EQUW	DOCOL
	EQUW	ZEQU
	EQUW	EXIT

;	!CSP

.L8C10	DEFWORD	"!CSP"
	EQUW	L8C04
.SCSP	EQUW	DOCOL
	EQUW	SPAT
	EQUW	CSP
	EQUW	STORE
	EQUW	EXIT

;	?ERROR

.L8C21	DEFWORD	"?ERROR"
	EQUW	L8C10
.QERR	EQUW	DOCOL
	EQUW	SWAP
	EQUW	ZBRAN,8
	EQUW	ERROR
	EQUW	BRAN,4
	EQUW	DROP
	EQUW	EXIT

;	?COMP

.L8C3C	DEFWORD	"?COMP"
	EQUW	L8C21
.QCOMP	EQUW	DOCOL
	EQUW	STATE
	EQUW	AT
	EQUW	ZEQU
	EQUW	LIT,17
	EQUW	QERR
	EQUW	EXIT

;	?EXEC

.L8C54	DEFWORD	"?EXEC"
	EQUW	L8C3C
.QEXEC	EQUW	DOCOL
	EQUW	STATE
	EQUW	AT
	EQUW	LIT,18
	EQUW	QERR
	EQUW	EXIT

;	?PAIRS

.L8C6A	DEFWORD	"?PAIRS"
	EQUW	L8C54
.QPAIR	EQUW	DOCOL
	EQUW	SUBB
	EQUW	LIT,19
	EQUW	QERR
	EQUW	EXIT

;	?CSP

.L8C7F	DEFWORD	"?CSP"
	EQUW	L8C6A
.QCSP	EQUW	DOCOL
	EQUW	SPAT
	EQUW	CSP
	EQUW	AT
	EQUW	SUBB
	EQUW	LIT,20
	EQUW	QERR
	EQUW	EXIT

;	?LOADING

.L8C98	DEFWORD	"?LOADING"
	EQUW	L8C7F
.QLOAD	EQUW	DOCOL
	EQUW	BLK
	EQUW	AT
	EQUW	ZEQU
	EQUW	LIT,22
	EQUW	QERR
	EQUW	EXIT

;	IMMEDIATE

.L8CB3	DEFWORD	"IMMEDIATE"
	EQUW	L8C98
.IMMED	EQUW	DOCOL
	EQUW	LAST
	EQUW	LIT,$40
	EQUW	TOGGL
	EQUW	EXIT

;	COMPILE

.L8CCB	DEFWORD	"COMPILE"
	EQUW	L8CB3
.COMP	EQUW	DOCOL
	EQUW	QCOMP
	EQUW	RFROM
	EQUW	DUPP
	EQUW	TWOP
	EQUW	TOR
	EQUW	AT
	EQUW	COMMA
	EQUW	EXIT

;	[

.L8CE7	DEFIMM	"["
	EQUW	L8CCB
.LBRAC	EQUW	DOCOL
	EQUW	ZERO
	EQUW	STATE
	EQUW	STORE
	EQUW	EXIT

;	]

.L8CF5	DEFWORD	"]"
	EQUW	L8CE7
.RBRAC	EQUW	DOCOL
	EQUW	LIT,$C0
	EQUW	STATE
	EQUW	STORE
	EQUW	EXIT

;	NOOP

.L8D05	DEFWORD	"NOOP"
	EQUW	L8CF5
.NOOP	EQUW	DOCOL
	EQUW	EXIT

;	?TAB

.L8D10	DEFWORD	"?TAB"
	EQUW	L8D05
.QTAB	EQUW	DOCOL
	EQUW	LIT,$FF9F
	EQUW	QKEY
	EQUW	ONE
	EQUW	ANDD
	EQUW	EXIT

;	HEX

.L8D25	DEFWORD	"HEX"
	EQUW	L8D10
.HEX	EQUW	DOCOL
	EQUW	LIT,16
	EQUW	BASE
	EQUW	STORE
	EQUW	EXIT

;	DECIMAL

.L8D37	DEFWORD	"DECIMAL"
	EQUW	L8D25
.DECIM	EQUW	DOCOL
	EQUW	LIT,10
	EQUW	BASE
	EQUW	STORE
	EQUW	EXIT

;	CR

.L8D4D	DEFWORD	"CR"
	EQUW	L8D37
.CRR	EQUW	DOCOL
	EQUW	LIT,$A
	EQUW	EMIT
	EQUW	LIT,$D
	EQUW	EMIT
	EQUW	NEGTWO
	EQUW	OUT
	EQUW	PSTOR
	EQUW	EXIT

;	(;CODE)

.L8D68	DEFWORD	"(;CODE)"
	EQUW	L8D4D
.PSCOD	EQUW	DOCOL
	EQUW	RFROM
	EQUW	LAST
	EQUW	PFA
	EQUW	CFA
	EQUW	STORE
	EQUW	EXIT

;	;CODE

.L8D80	DEFIMM	";CODE"
	EQUW	L8D68
.L8D88	EQUW	DOCOL
	EQUW	QCSP
	EQUW	COMP
	EQUW	PSCOD
	EQUW	LBRAC
	EQUW	ASSEM
	EQUW	SCSP
	EQUW	EXIT

;	DOES>

.L8D98	DEFIMM	"DOES>"
	EQUW	L8D80
.DOES	EQUW	DOCOL
	EQUW	COMP
	EQUW	PSCOD
	EQUW	LIT,$20
	EQUW	CCOMM
	EQUW	COMP
	EQUW	DODOE
	EQUW	EXIT

.DODOE	DEX
	DEX
	CLC
	LDA	W
	ADC	#2
	STA	0,X
	TYA
	ADC	W+1
	STA	1,X
	SEC
	PLA
	SBC	#1
	STA	W
	PLA
	SBC	#0
	STA	W+1
	JMP	DOCOL

;	0>

.L8DCE	DEFWORD	"0>"
	EQUW	L8D98
.ZGREA	EQUW	DOCOL
	EQUW	NEGAT
	EQUW	ZLESS
	EQUW	EXIT

;	COUNT

.L8DDB	DEFWORD	"COUNT"
	EQUW	L8DCE
.COUNT	EQUW	DOCOL
	EQUW	DUPP
	EQUW	ONEP
	EQUW	SWAP
	EQUW	CAT
	EQUW	EXIT

;	TYPE

.L8DEF	DEFWORD	"TYPE"
	EQUW	L8DDB
.TYPE	EQUW	DOCOL
	EQUW	DUPP
	EQUW	ZGREA
	EQUW	ZBRAN,$18
	EQUW	OVER
	EQUW	PLUS
	EQUW	SWAP
	EQUW	XDO
	EQUW	IDO
	EQUW	CAT
	EQUW	EMIT
	EQUW	XPULO,$FFF8
	EQUW	BRAN,4
	EQUW	TDROP
	EQUW	EXIT

;	-TRAILING

.L8E1A	DEFWORD	"-TRAILING"
	EQUW	L8DEF
.DTRAI	EQUW	DOCOL
	EQUW	DUPP
	EQUW	ZLESS
	EQUW	LIT,5
	EQUW	QERR
	EQUW	DUPP
	EQUW	ZERO
	EQUW	XDO
	EQUW	TDUP
	EQUW	PLUS
	EQUW	ONESUB
	EQUW	CAT
	EQUW	BLL
	EQUW	SUBB
	EQUW	ZBRAN,8
	EQUW	LEAV
	EQUW	BRAN,4
	EQUW	ONESUB
	EQUW	XPULO,$FFE6
	EQUW	EXIT

;	TEXT,

.L8E56	DEFWORD	"TEXT,"
	EQUW	L8E1A
.TXTCOM	EQUW	DOCOL
	EQUW	DUPP
	EQUW	CCOMM
	EQUW	HERE
	EQUW	OVER
	EQUW	ALLOT
	EQUW	SWAP
	EQUW	CMOVE
	EQUW	EXIT

;	(.")

.L8E70	DEFWORD	"(."")"
	EQUW	L8E56
.PDOTQ	EQUW	DOCOL
	EQUW	RAT
	EQUW	COUNT
	EQUW	DUPP
	EQUW	ONEP
	EQUW	RFROM
	EQUW	PLUS
	EQUW	TOR
	EQUW	TYPE
	EQUW	EXIT

;	."

.L8E8B	DEFIMM	"."""
	EQUW	L8E70
.DOTQ	EQUW	DOCOL
	EQUW	MIN1
	EQUW	INN
	EQUW	PSTOR
	EQUW	LIT,$22
	EQUW	PWORD
	EQUW	ONESUB
	EQUW	QDUP
	EQUW	ZBRAN,$20
	EQUW	SWAP
	EQUW	ONEP
	EQUW	SWAP
	EQUW	STATE
	EQUW	AT
	EQUW	ZBRAN,$C
	EQUW	COMP
	EQUW	PDOTQ
	EQUW	TXTCOM
	EQUW	BRAN,4
	EQUW	TYPE
	EQUW	BRAN,4
	EQUW	DROP
	EQUW	EXIT

;	(EXPECT)

.L8EC8	DEFWORD	"(EXPECT)"
	EQUW	L8E8B
.PEXPEC	EQUW	*+2
	STX	XSAVE
	DEX
	LDA	3,X
	STA	0,X
	LDA	1,X
	STA	2,X
	LDA	4,X
	STA	1,X
	LDA	#$20
	STA	3,X
	LDA	#$FF
	STA	4,X
	LDA	#0
	JSR	$FFF1
	LDX	XSAVE
	STY	2,X
	LDA	#0
	STA	3,X
	JMP	POP

;	EXPECT

.L8EFC	DEFWORD	"EXPECT"
	EQUW	L8EC8
.EXPECT	EQUW	DOCOL
	EQUW	OVER
	EQUW	SWAP
	EQUW	PEXPEC
	EQUW	PLUS
	EQUW	ZERO
	EQUW	SWAP
	EQUW	STORE
	EQUW	EXIT

;	QUERY

.L8F17	DEFWORD	"QUERY"
	EQUW	L8EFC
.QUERY	EQUW	DOCOL
	EQUW	TIB
	EQUW	AT
	EQUW	LIT,80
	EQUW	EXPECT
	EQUW	ZERO
	EQUW	INN
	EQUW	STORE
	EQUW	EXIT

;	ASCII NULL

.L8F33	DEFIMM	CHR$(0)
	EQUW	L8F17
.NULL	EQUW	DOCOL
	EQUW	BLK
	EQUW	AT
	EQUW	ZBRAN,$28
	EQUW	ONE
	EQUW	BLK
	EQUW	PSTOR
	EQUW	ZERO
	EQUW	INN
	EQUW	STORE
	EQUW	BLK
	EQUW	AT
	EQUW	BSCR
	EQUW	ONESUB
	EQUW	ANDD
	EQUW	ZEQU
	EQUW	ZBRAN,8
	EQUW	QEXEC
	EQUW	RFROM
	EQUW	DROP
	EQUW	BRAN,6
	EQUW	RFROM
	EQUW	DROP
	EQUW	EXIT

;	MOVE

.L8F6D	DEFWORD	"MOVE"
	EQUW	L8F33
.MOVE	EQUW	DOCOL
	EQUW	DUPP
	EQUW	PLUS
	EQUW	CMOVE
	EQUW	EXIT

;	FILL

.L8F7E	DEFWORD	"FILL"
	EQUW	L8F6D
.FILL	EQUW	DOCOL
	EQUW	OVER
	EQUW	ONE
	EQUW	LESS
	EQUW	ZBRAN,$A
	EQUW	DROP
	EQUW	TDROP
	EQUW	BRAN,$14
	EQUW	SWAP
	EQUW	TOR
	EQUW	OVER
	EQUW	CSTOR
	EQUW	DUPP
	EQUW	ONEP
	EQUW	RFROM
	EQUW	ONESUB
	EQUW	CMOVE
	EQUW	EXIT

;	ERASE

.L8FAD	DEFWORD	"ERASE"
	EQUW	L8F7E
.ERASE	EQUW	DOCOL
	EQUW	ZERO
	EQUW	FILL
	EQUW	EXIT

;	BLANKS

.L8FBD	DEFWORD	"BLANKS"
	EQUW	L8FAD
.BLANKS	EQUW	DOCOL
	EQUW	BLL
	EQUW	FILL
	EQUW	EXIT

;	HOLD

.L8FCE	DEFWORD	"HOLD"
	EQUW	L8FBD
.HOLD	EQUW	DOCOL
	EQUW	MIN1
	EQUW	HLD
	EQUW	PSTOR
	EQUW	HLD
	EQUW	AT
	EQUW	CSTOR
	EQUW	EXIT

;	(WORD)  ( C -- ADR LEN )

.L8FE5	DEFWORD	"(WORD)"
	EQUW	L8FCE
.PWORD	EQUW	DOCOL
	EQUW	BLK
	EQUW	AT
	EQUW	QDUP
	EQUW	ZBRAN,8
	EQUW	BLOCK
	EQUW	BRAN,6
	EQUW	TIB
	EQUW	AT
	EQUW	INN
	EQUW	AT
	EQUW	PLUS
	EQUW	SWAP
	EQUW	ENCL
	EQUW	INN
	EQUW	PSTOR
	EQUW	OVER
	EQUW	SUBB
	EQUW	ROT
	EQUW	ROT
	EQUW	PLUS
	EQUW	SWAP
	EQUW	EXIT

;	WDSZ

.L9020	DEFWORD	"WDSZ"
	EQUW	L8FE5
.WDSZ	EQUW	DOCON
	EQUW	WBSIZ		; WORD BUFFER SIZE

;	WBFR

.L902B	DEFWORD	"WBFR"
	EQUW	L9020
.WBFR	EQUW	DOCON
	EQUW	WORDBU		; WORD BUFFER ADDR

;	1WORD

.L9036	DEFWORD	"1WORD"
	EQUW	L902B
.ONEWRD	EQUW	DOCOL
	EQUW	PWORD
	EQUW	WDSZ
	EQUW	MIN
	EQUW	WBFR
	EQUW	CSTOR
	EQUW	WBFR
	EQUW	COUNT
	EQUW	ONEP
	EQUW	CMOVE
	EQUW	WBFR
	EQUW	EXIT

;	WORD

.L9056	DEFWORD	"WORD"
	EQUW	L9036
.WORD	EQUW	DOCOL
	EQUW	ONEWRD
	EQUW	DUPP
	EQUW	ONEP
	EQUW	CAT
	EQUW	ZEQU
	EQUW	ZBRAN,8
	EQUW	ZERO
	EQUW	OVER
	EQUW	CSTOR
	EQUW	EXIT

;	CONVERT

.L9075	DEFWORD	"CONVERT"
	EQUW	L9056
.CONV	EQUW	DOCOL
	EQUW	ONEP
	EQUW	DUPP
	EQUW	TOR
	EQUW	CAT
	EQUW	BASE
	EQUW	AT
	EQUW	DIGIT
	EQUW	ZBRAN,$1C
	EQUW	SWAP
	EQUW	BASE
	EQUW	AT
	EQUW	USTAR
	EQUW	DROP
	EQUW	ROT
	EQUW	BASE
	EQUW	AT
	EQUW	USTAR
	EQUW	DPLUS
	EQUW	RFROM
	EQUW	BRAN,$FFD6
	EQUW	RFROM
	EQUW	EXIT

;	-FIND

.L90B1	DEFWORD	"-FIND"
	EQUW	L9075
.DFIND	EQUW	DOCOL
	EQUW	BLL
	EQUW	ONEWRD
	EQUW	SWAP
	EQUW	PFIND
	EQUW	EXIT

;	FIND

.L90C5	DEFWORD	"FIND"
	EQUW	L90B1
.FIND	EQUW	DOCOL
	EQUW	CONT
	EQUW	AT
	EQUW	AT
	EQUW	DFIND
	EQUW	ZBRAN,8
	EQUW	DROP
	EQUW	BRAN,4
	EQUW	ZERO
	EQUW	EXIT

;	ERROR

.L90E4	DEFWORD	"ERROR"
	EQUW	L90C5
.ERROR	EQUW	DOCOL
	EQUW	WARN
	EQUW	AT
	EQUW	ZLESS
	EQUW	ZBRAN,8
	EQUW	ABORT
	EQUW	BRAN,$1F
	EQUW	WBFR
	EQUW	COUNT
	EQUW	TYPE
	EQUW	PDOTQ
	EQUB	4,"  ? "
	EQUW	MESS
	EQUW	SPSTO
	EQUW	TDROP
	EQUW	INN
	EQUW	AT
	EQUW	BLK
	EQUW	AT
	EQUW	QUIT
	EQUW	EXIT

;	ID.

.L911D	DEFWORD	"ID."
	EQUW	L90E4
.IDDOT	EQUW	DOCOL
	EQUW	PAD
	EQUW	BLL
	EQUW	LIT,'_'
	EQUW	FILL
	EQUW	DUPP
	EQUW	PFA
	EQUW	LFA
	EQUW	OVER
	EQUW	SUBB
	EQUW	PAD
	EQUW	SWAP
	EQUW	CMOVE
	EQUW	PAD
	EQUW	COUNT
	EQUW	LIT,$1F
	EQUW	ANDD
	EQUW	TYPE
	EQUW	SPACE
	EQUW	EXIT

;	(CREATE)

.L914F	DEFWORD	"(CREATE)"
	EQUW	L911D
.PCREAT	EQUW	DOCOL
	EQUW	FIRST
	EQUW	HERE
	EQUW	LIT,$A0
	EQUW	PLUS
	EQUW	ULESS
	EQUW	TWO
	EQUW	QERR
	EQUW	BLL
	EQUW	WORD
	EQUW	DUPP
	EQUW	CAT
	EQUW	DUPP
	EQUW	ZEQU
	EQUW	LIT,10
	EQUW	QERR
	EQUW	OVER
	EQUW	CONT
	EQUW	AT
	EQUW	AT
	EQUW	PFIND
	EQUW	ZBRAN,$12
	EQUW	DROP
	EQUW	TWOP
	EQUW	NFA
	EQUW	IDDOT
	EQUW	LIT,4
	EQUW	MESS
	EQUW	SPACE
	EQUW	WIDTH
	EQUW	AT
	EQUW	MIN
	EQUW	DUPP
	EQUW	DP
	EQUW	CAT
	EQUW	PLUS
	EQUW	LIT,$FC
	EQUW	EQUAL
	EQUW	ALLOT
	EQUW	ONEP
	EQUW	DUPP
	EQUW	TOR
	EQUW	HERE
	EQUW	SWAP
	EQUW	CMOVE
	EQUW	HERE
	EQUW	RFROM
	EQUW	ALLOT
	EQUW	DUPP
	EQUW	LIT,$80
	EQUW	TOGGL
	EQUW	HERE
	EQUW	ONESUB
	EQUW	LIT,$80
	EQUW	TOGGL
	EQUW	LAST
	EQUW	COMMA
	EQUW	CURR
	EQUW	AT
	EQUW	STORE
	EQUW	LIT,DOVAR
	EQUW	COMMA
	EQUW	EXIT

;	[COMPILE]

.L91E8	DEFIMM	"[COMPILE]"
	EQUW	LA028-REL
.BCOMP	EQUW	DOCOL
	EQUW	CONT
	EQUW	AT
	EQUW	AT
	EQUW	DFIND
	EQUW	ZEQU
	EQUW	ZERO
	EQUW	QERR
	EQUW	DROP
	EQUW	COMMA
	EQUW	EXIT

;	LITERAL

.L920A	DEFIMM	"LITERAL"
	EQUW	L91E8
.LITER	EQUW	DOCOL
	EQUW	STATE
	EQUW	AT
	EQUW	ZBRAN,8
	EQUW	COMP
	EQUW	LIT
	EQUW	COMMA
	EQUW	EXIT

;	DLITERAL

.L9226	DEFIMM	"DLITERAL"
	EQUW	L920A
.DLITER	EQUW	DOCOL
	EQUW	STATE
	EQUW	AT
	EQUW	ZBRAN,8
	EQUW	SWAP
	EQUW	LITER
	EQUW	LITER
	EQUW	EXIT

;	?STACK

.L9243	DEFWORD	"?STACK"
	EQUW	L9226
.QSTAC	EQUW	DOCOL
	EQUW	SPAT
	EQUW	SZERO
	EQUW	AT
	EQUW	GREAT
	EQUW	ONE
	EQUW	QERR
	EQUW	SPAT
	EQUW	LIT,BOS
	EQUW	LESS
	EQUW	LIT,7
	EQUW	QERR
	EQUW	EXIT

;	:

.L926A	DEFWORD	":"
	EQUW	L9243
.COLON	EQUW	DOCOL
	EQUW	RCOLON
	EQUW	SMUDG
	EQUW	EXIT

;	;

.L9276	DEFIMM	";"
	EQUW	L926A
.SEMIS	EQUW	DOCOL
	EQUW	RSEMI
	EQUW	SMUDG
	EQUW	EXIT

;	NUMBER

.L9282	DEFWORD	"NUMBER"
	EQUW	L9276
.NUMBER	EQUW	DOCOL
	EQUW	DUPP
	EQUW	CAT
	EQUW	OVER
	EQUW	PLUS
	EQUW	TOR
	EQUW	ZERO
	EQUW	ZERO
	EQUW	ROT
	EQUW	DUPP
	EQUW	ONEP
	EQUW	CAT
	EQUW	LIT,'-'
	EQUW	EQUAL
	EQUW	DUPP
	EQUW	TOR
	EQUW	PLUS
	EQUW	CONV
	EQUW	RFROM
	EQUW	ZBRAN,8
	EQUW	TOR
	EQUW	DNEGAT
	EQUW	RFROM
	EQUW	RFROM
	EQUW	OVER
	EQUW	SUBB
	EQUW	DUPP
	EQUW	ZLESS
	EQUW	ZBRAN,8
	EQUW	TDROP
	EQUW	BRAN,$12
	EQUW	ZERO
	EQUW	QERR
	EQUW	CAT
	EQUW	LIT,'.'
	EQUW	SUBB
	EQUW	ZERO
	EQUW	QERR
	EQUW	EXIT

;	(

.L92E3	DEFIMM	"("
	EQUW	L9282
.PAREN	EQUW	DOCOL
	EQUW	MIN1
	EQUW	INN
	EQUW	PSTOR
	EQUW	LIT,')'
	EQUW	WORD
	EQUW	DROP
	EQUW	EXIT

;	(NUM)

.L92F9	DEFWORD	"(NUM)"
	EQUW	L92E3
.PNUM	EQUW	DOCOL
	EQUW	DUPP
	EQUW	CAT
	EQUW	OVER
	EQUW	PLUS
	EQUW	SWAP
	EQUW	NUMBER
	EQUW	ROT
	EQUW	CAT
	EQUW	LIT,'.'
	EQUW	SUBB
	EQUW	ZBRAN,$A
	EQUW	DROP
	EQUW	LITER
	EQUW	BRAN,4
	EQUW	DLITER
	EQUW	EXIT

;	INTERPRET

.L9329	DEFWORD	"INTERPRET"
	EQUW	LA035-REL
.INTE	EQUW	DOCOL
	EQUW	CONT
	EQUW	AT
	EQUW	AT
	EQUW	DFIND
	EQUW	ZBRAN,$18
	EQUW	STATE
	EQUW	AT
	EQUW	LESS
	EQUW	ZBRAN,8
	EQUW	COMMA
	EQUW	BRAN,4
	EQUW	EXEC
	EQUW	BRAN,6
	EQUW	WBFR
	EQUW	NUM
	EQUW	QSTAC
	EQUW	BRAN,$FFD6
	EQUW	EXIT

;	VOCABULARY

.L9365	DEFWORD	"VOCABULARY"
	EQUW	L9329
.VOC	EQUW	DOCOL
	EQUW	CREAT
	EQUW	LIT,$A081
	EQUW	COMMA
	EQUW	CURR
	EQUW	AT
	EQUW	CFA
	EQUW	COMMA
	EQUW	HERE
	EQUW	VOCL
	EQUW	AT
	EQUW	COMMA
	EQUW	VOCL
	EQUW	STORE
	EQUW	PSCOD
.DOVOC	JSR	DODOE
	EQUW	TWOP
	EQUW	CONT
	EQUW	STORE
	EQUW	EXIT

; -----------------------------------------------------------------------------
;
;	QUIT   ( ... )
;
;	> Clears the return stack, stops and
;	> returns control to the keyboard. No message is given.
;
;	: QUIT
;	 0 BLK !
;	 [
;	 RP!
;	 BEGIN
;	  CR
;	  QUERY INTERPRET
;	  STATE @ 0= IF
;	   ." OK"
;	  THEN
;	 AGAIN
;	;
;
; -----------------------------------------------------------------------------

.L939D	DEFWORD	"QUIT"
	EQUW	LA03F-REL
.QUIT	EQUW	DOCOL
	EQUW	ZERO
	EQUW	BLK
	EQUW	STORE
	EQUW	LBRAC
	EQUW	RPSTO
	EQUW	CRR
	EQUW	QUERY
	EQUW	INTE
	EQUW	STATE
	EQUW	AT
	EQUW	ZEQU
	EQUW	ZBRAN,7
	EQUW	PDOTQ
	EQUB	2,"OK"
	EQUW	BRAN,$FFE7
	EQUW	EXIT

;	DEFINITIONS

.L93CB	DEFWORD	"DEFINITIONS"
	EQUW	L939D
.DEFIN	EQUW	DOCOL
	EQUW	CONT
	EQUW	AT
	EQUW	CURR
	EQUW	STORE
	EQUW	EXIT

; -----------------------------------------------------------------------------
;
;	(WARM)
;
;	> A routine which returns control to the
;	> keyboard interpreter. It is used by COLD, WARM and the
;	> error-handling procedures. The numeric base is set to
;	> decimal and FORTH becomes both the current and context
;	> vocabularies. The return stack (but not the computation
;	> stack) is cleared.
;
;	: (WARM)
;	 SP!
;	 CR ." OK"
;	 DECIMAL
;	 FORTH DEFINITIONS
;	 QUIT
;	;
;
; -----------------------------------------------------------------------------

.L93E5	DEFWORD	"(WARM)"
	EQUW	L93CB
.PWARM	EQUW	DOCOL
	EQUW	SPSTO
	EQUW	CRR
	EQUW	PDOTQ
	EQUB	2,"OK"
	EQUW	DECIM
	EQUW	FORTH
	EQUW	DEFIN
	EQUW	QUIT
	EQUW	EXIT

; -----------------------------------------------------------------------------
;
;	(ABORT)   ( ... )
;
;	> Clears the data and return stacks and
;	> sets execution mode. Control is returned to the
;	> keyboard interpreter. See ABORT .
;
;	: (ABORT)
;	 SP!
;	 CR CR ." FORTH"
;	 (WARM)
;	;
;
; -----------------------------------------------------------------------------

.L9403	DEFWORD	"(ABORT)"
	EQUW	L93E5
.PABOR	EQUW	DOCOL
	EQUW	SPSTO
	EQUW	CRR
	EQUW	CRR
	EQUW	PDOTQ
	EQUB	5,"FORTH"
	EQUW	PWARM
	EQUW	EXIT

; -----------------------------------------------------------------------------
;
;	ESCAPE
;
;	> Prints the message 'Escape' and re-enters
;	> the system via QUIT. This is the routine executed when
;	> the ESCAPE key is pressed.
;
;	: ESCAPE
;	 SP!
;	 CR ." Escape"
;	 QUIT
;	;
;
; -----------------------------------------------------------------------------

.L9421	DEFWORD	"ESCAPE"
	EQUW	LA04F-REL
.ESCAPE	EQUW	DOCOL
	EQUW	SPSTO
	EQUW	CRR
	EQUW	PDOTQ
	EQUB	6,"Escape"
	EQUW	QUIT
	EQUW	EXIT

;-----------------------------------------------------------------------------
;
;	OSERROR
;
;	> The routine executed when an operating
;	> system error is detected. The error message number is
;	> given in decimal base and the relevant operating system
;	> error message is displayed. Controls is returned to the
;	> keyboard via (WARM).
;
;	: OSERROR
;	 SP!
;	 CR ." O.S.Error "   $00FD @   DUP C@ DEC.
;	 0 CLOSE
;	 SPACE   BEGIN
;	          1+
;	          DUP C@
;	          DUP
;	         WHILE
;	          EMIT
;	         REPEAT
;	 2DROP
;	 (WARM)
;	;
;
; -----------------------------------------------------------------------------

.L943D	DEFWORD	"OSERROR"
	EQUW	L9421
.OSERR	EQUW	DOCOL
	EQUW	SPSTO
	EQUW	CRR
	EQUW	PDOTQ
	EQUB	10,"O.S.Error "
	EQUW	LIT,$FD
	EQUW	AT
	EQUW	DUPP
	EQUW	CAT
	EQUW	DECDOT
	EQUW	ZERO
	EQUW	CLOSE
	EQUW	SPACE
	EQUW	ONEP
	EQUW	DUPP
	EQUW	CAT
	EQUW	DUPP
	EQUW	ZBRAN,8
	EQUW	EMIT
	EQUW	BRAN,$FFF0
	EQUW	TDROP
	EQUW	PWARM
	EQUW	EXIT

;	MODE

.L9484	DEFWORD	"MODE"
	EQUW	L943D
.MODE	EQUW	DOCOL
	EQUW	HIADR
	EQUW	MIN1
	EQUW	EQUAL
	EQUW	ZBRAN,8
	EQUW	DUPP
	EQUW	MODADR
	EQUW	MOVBUF
	EQUW	LIT,$16
	EQUW	TOVDU
	EQUW	TOVDU
	EQUW	EXIT

; -----------------------------------------------------------------------------
;
;	START   ( ... )
;
;	> The high-level entry point to FORTH on a
;	> cold start. The computation and return stacks are
;	> cleared. Any applications dictionary is discarded and
;	> all vectored words are initialised to their default
;	> values. The mass storage buffers are initialised to the
;	> number of buffers given by MINBUF and marked as being
;	> empty; OFFSET is set to zero. User-defined keys 8 and 9
;	> are programmed for the correct WARM and COLD entry
;	> points respectively and printer output is disabled.
;	> Control is passed to the keyboard interpreter via
;	> (ABORT) .
;
;	: START
;	 SP!
;	 INITVECS   INITBUF   0 OFFSET !
;	 $1E +ORIGIN @ PRUNE
;	 3 >VDU
;	 PAGE 2+   DUP DP !   FENCE !
;	 (ABORT)
;	;
;
; -----------------------------------------------------------------------------

.L94A7	DEFWORD	"START"
	EQUW	L9484
.START	EQUW	DOCOL
	EQUW	SPSTO

IF KEEP_IN_ROM=FALSE

	EQUW	LIT,L9FFB
	EQUW	LIT,RAM
	EQUW	LIT,LA19F-L9FFB
	EQUW	CMOVE
ENDIF
	EQUW	INIVEC
	EQUW	INIBUF
	EQUW	ZERO
	EQUW	OFFSE
	EQUW	STORE
	EQUW	LIT,$1E
	EQUW	PORIG
	EQUW	AT
	EQUW	PRUNE
	EQUW	LIT,3
	EQUW	TOVDU
	EQUW	PAGE
	EQUW	TWOP
	EQUW	DUPP
	EQUW	DP
	EQUW	STORE
	EQUW	FENCE
	EQUW	STORE
	EQUW	PABOR
	EQUW	EXIT

; -----------------------------------------------------------------------------
;
;	ESCAPE PRESSED HANDLER
;
; -----------------------------------------------------------------------------

.L94ED	LDA	#$7E		; CLEAR ESCAPE CONDITION
	JSR	$FFF4
	LDA	L812C+1		; SET IP TO ESCAPE WORD
	STA	IP+1
	LDA	L812C
	STA	IP
	LDY	#$F		; RESTART EXECUTION
	JMP	L8130

; -----------------------------------------------------------------------------
;
;	BRK HANDLER
;
; -----------------------------------------------------------------------------

.L9501	LDA	L812E+1		; SET IP TO OSERROR WORD
	STA	IP+1
	LDA	L812E
	STA	IP
	LDY	#$F		; RESTART EXECUTION
	JMP	L8130

; -----------------------------------------------------------------------------
;
;	COLD
;
;	> The cold start procedure used on first
;	> entry to the system. The dictionary pointer and user
;	> variables are initialised from the boot-up parameters
;	> and the system re-started via (ABORT). The mass
;	> storage buffers are cleared, function keys 8 and 9 are
;	> initialised, and printer output is disabled. All
;	> vectored words are set to their default actions. It
;	> may be called from the keyboard to remove all
;	> application programs and restart with the nucleus
;	> dictionary alone.
;
; -----------------------------------------------------------------------------

.L9510	DEFWORD	"COLD"
	EQUW	L94A7
.COLD	EQUW	*+2
	LDA	L812A+1		; SET (BRKV) TO BRK HANDLER
	STA	$203
	LDA	L812A
	STA	$202
	LDA	L8108+1		; SET IP TO START WORD
	STA	IP+1
	LDA	L8108
	STA	IP
	LDY	#$15		; RESTART EXECUTION
	JMP	L8130

; -----------------------------------------------------------------------------
;
;	WARM
;
;	> Performs a warm start. The stacks are
;	> cleared. The CURRENT and CONTEXT vocabularies are set
;	> to FORTH, and DECIMAL numeric base is selected. No
;	> other initialisation takes place. In particular the
;	> user's dictionary and the contents of the buffer are
;	> preserved. All vectored routines maintain their current
;	> assignments.
;
; -----------------------------------------------------------------------------

.L9534	DEFWORD	"WARM"
	EQUW	L9510
.WARM	EQUW	*+2
	LDA	L810A+1		; SET IP TO (ABORT)
	STA	IP+1
	LDA	L810A
	STA	IP
	LDA	L812A+1		; SET (BRKV) TO BRK HANDLER
	STA	$203
	LDA	L812A
	STA	$202
	LDY	#$F
	JMP	L8130		; RESTART EXECUTION

;	S->D

.L9558	DEFWORD	"S->D"
	EQUW	L9534
.STOD	EQUW	*+2
	LDA	1,X
	BPL	L9566
	DEY
.L9566	TYA
	PHA
	JMP	PUSH

;	+-

.L956B	DEFWORD	"+-"
	EQUW	L9558
.PM	EQUW	DOCOL
	EQUW	ZLESS
	EQUW	ZBRAN,4
	EQUW	NEGAT
	EQUW	EXIT

;	D+-

.L957C	DEFWORD	"D+-"
	EQUW	L956B
.DPM	EQUW	DOCOL
	EQUW	ZLESS
	EQUW	ZBRAN,4
	EQUW	DNEGAT
	EQUW	EXIT

;	ABS

.L958E	DEFWORD	"ABS"
	EQUW	L957C
.ABS	EQUW	DOCOL
	EQUW	DUPP
	EQUW	PM
	EQUW	EXIT

;	DABS

.L959C	DEFWORD	"DABS"
	EQUW	L958E
.DABS	EQUW	DOCOL
	EQUW	DUPP
	EQUW	DPM
	EQUW	EXIT

;	MIN

.L95AB	DEFWORD	"MIN"
	EQUW	L959C
.MIN	EQUW	DOCOL
	EQUW	TDUP
	EQUW	GREAT
	EQUW	ZBRAN,4
	EQUW	SWAP
	EQUW	DROP
	EQUW	EXIT

;	MAX

.L95C1	DEFWORD	"MAX"
	EQUW	L95AB
.MAX	EQUW	DOCOL
	EQUW	TDUP
	EQUW	LESS
	EQUW	ZBRAN,4
	EQUW	SWAP
	EQUW	DROP
	EQUW	EXIT

;	U/MOD

.L95D7	DEFWORD	"U/MOD"
	EQUW	L95C1
.USMOD	EQUW	DOCOL
	EQUW	QDUP
	EQUW	ZBRAN,8
	EQUW	USLAS
	EQUW	BRAN,8
	EQUW	LIT,11
	EQUW	ERROR
	EQUW	EXIT

;	M*

.L95F5	DEFWORD	"M*"
	EQUW	L95D7
.MSTAR	EQUW	DOCOL
	EQUW	TDUP
	EQUW	XORR
	EQUW	TOR
	EQUW	ABS
	EQUW	SWAP
	EQUW	ABS
	EQUW	USTAR
	EQUW	RFROM
	EQUW	DPM
	EQUW	EXIT

;	M/

.L9610	DEFWORD	"M/"
	EQUW	L95F5
.MSLAS	EQUW	DOCOL
	EQUW	OVER
	EQUW	TOR
	EQUW	TOR
	EQUW	DABS
	EQUW	RAT
	EQUW	ABS
	EQUW	USMOD
	EQUW	RFROM
	EQUW	RAT
	EQUW	XORR
	EQUW	PM
	EQUW	SWAP
	EQUW	RFROM
	EQUW	PM
	EQUW	SWAP
	EQUW	EXIT

;	*

.L9637	DEFWORD	"*"
	EQUW	L9610
.STAR	EQUW	DOCOL
	EQUW	USTAR
	EQUW	DROP
	EQUW	EXIT

;	/MOD

.L9643	DEFWORD	"/MOD"
	EQUW	L9637
.SLMOD	EQUW	DOCOL
	EQUW	TOR
	EQUW	STOD
	EQUW	RFROM
	EQUW	MSLAS
	EQUW	EXIT

;	/

.L9656	DEFWORD	"/"
	EQUW	L9643
.SLASH	EQUW	DOCOL
	EQUW	SLMOD
	EQUW	SWAP
	EQUW	DROP
	EQUW	EXIT

;	MOD

.L9664	DEFWORD	"MOD"
	EQUW	L9656
.MOD	EQUW	DOCOL
	EQUW	SLMOD
	EQUW	DROP
	EQUW	EXIT

;	*/MOD

.L9672	DEFWORD	"*/MOD"
	EQUW	L9664
.SSLMOD	EQUW	DOCOL
	EQUW	TOR
	EQUW	MSTAR
	EQUW	RFROM
	EQUW	MSLAS
	EQUW	EXIT

;	*/

.L9686	DEFWORD	"*/"
	EQUW	L9672
.SSLASH	EQUW	DOCOL
	EQUW	SSLMOD
	EQUW	SWAP
	EQUW	DROP
	EQUW	EXIT

;	M/MOD

.L9695	DEFWORD	"M/MOD"
	EQUW	L9686
.MSLMOD	EQUW	DOCOL
	EQUW	TOR
	EQUW	ZERO
	EQUW	RAT
	EQUW	USMOD
	EQUW	RFROM
	EQUW	SWAP
	EQUW	TOR
	EQUW	USMOD
	EQUW	RFROM
	EQUW	EXIT

;	SPACES

.L96B3	DEFWORD	"SPACES"
	EQUW	L9695
.SPACS	EQUW	DOCOL
	EQUW	ZERO
	EQUW	MAX
	EQUW	QDUP
	EQUW	ZBRAN,$C
	EQUW	ZERO
	EQUW	XDO
	EQUW	SPACE
	EQUW	XPULO,$FFFC
	EQUW	EXIT

;	<#

.L96D4	DEFWORD	"<#"
	EQUW	L96B3
.BDIG	EQUW	DOCOL
	EQUW	PAD
	EQUW	HLD
	EQUW	STORE
	EQUW	EXIT

;	#>

.L96E3	DEFWORD	"#>"
	EQUW	L96D4
.EDIG	EQUW	DOCOL
	EQUW	TDROP
	EQUW	HLD
	EQUW	AT
	EQUW	PAD
	EQUW	OVER
	EQUW	SUBB
	EQUW	EXIT

	EQUB	$66

;	SIGN

.L96F9	DEFWORD	"SIGN"
	EQUW	L96E3
.SIGN	EQUW	DOCOL
	EQUW	ROT
	EQUW	ZLESS
	EQUW	ZBRAN,8
	EQUW	LIT,'-'
	EQUW	HOLD
	EQUW	EXIT

;	#

.L9712	DEFWORD	"#"
	EQUW	L96F9
.DIG	EQUW	DOCOL
	EQUW	BASE
	EQUW	AT
	EQUW	MSLMOD
	EQUW	ROT
	EQUW	LIT,9
	EQUW	OVER
	EQUW	LESS
	EQUW	ZBRAN,8
	EQUW	LIT,7
	EQUW	PLUS
	EQUW	LIT,'0'
	EQUW	PLUS
	EQUW	HOLD
	EQUW	EXIT

;	#S

.L973C	DEFWORD	"#S"
	EQUW	L9712
.DIGS	EQUW	DOCOL
	EQUW	DIG
	EQUW	TDUP
	EQUW	ORR
	EQUW	ZEQU
	EQUW	ZBRAN,$FFF6
	EQUW	EXIT

;	D.R

.L9751	DEFWORD	"D.R"
	EQUW	L973C
.DDOTR	EQUW	DOCOL
	EQUW	TOR
	EQUW	SWAP
	EQUW	OVER
	EQUW	DABS
	EQUW	BDIG
	EQUW	DIGS
	EQUW	SIGN
	EQUW	EDIG
	EQUW	RFROM
	EQUW	OVER
	EQUW	SUBB
	EQUW	SPACS
	EQUW	TYPE
	EQUW	EXIT

;	D.

.L9775	DEFWORD	"D."
	EQUW	L9751
.DDOT	EQUW	DOCOL
	EQUW	ZERO
	EQUW	DDOTR
	EQUW	SPACE
	EQUW	EXIT

;	.R

.L9784	DEFWORD	".R"
	EQUW	L9775
.DOTR	EQUW	DOCOL
	EQUW	TOR
	EQUW	STOD
	EQUW	RFROM
	EQUW	DDOTR
	EQUW	EXIT

;	.

.L9795	DEFWORD	"."
	EQUW	L9784
.DOT	EQUW	DOCOL
	EQUW	STOD
	EQUW	DDOT
	EQUW	EXIT

;	U.

.L97A1	DEFWORD	"U."
	EQUW	L9795
.UDOT	EQUW	DOCOL
	EQUW	ZERO
	EQUW	DDOT
	EQUW	EXIT

;	?

.L97AE	DEFWORD	"?"
	EQUW	L97A1
.QUES	EQUW	DOCOL
	EQUW	AT
	EQUW	DOT
	EQUW	EXIT

;	DEC.

.L97BA	DEFWORD	"DEC."
	EQUW	L97AE
.DECDOT	EQUW	DOCOL
	EQUW	BASE
	EQUW	AT
	EQUW	SWAP
	EQUW	DECIM
	EQUW	DOT
	EQUW	BASE
	EQUW	STORE
	EQUW	EXIT

;	H.

.L97D3	DEFWORD	"H."
	EQUW	L97BA
.HDOT	EQUW	DOCOL
	EQUW	BASE
	EQUW	AT
	EQUW	SWAP
	EQUW	HEX
	EQUW	DOT
	EQUW	BASE
	EQUW	STORE
	EQUW	EXIT

;	MSG#

.L97EA	DEFWORD	"MSG#"
	EQUW	L97D3
.MSGNUM	EQUW	DOCOL
	EQUW	QDUP
	EQUW	ZBRAN,$D
	EQUW	PDOTQ
	EQUB	6,"MSG # "
	EQUW	DECDOT
	EQUW	EXIT

;	2*

.L9806	DEFWORD	"2*"
	EQUW	LA05B-REL
.TSTAR	EQUW	*+2
	ASL	0,X
	ROL	1,X
	JMP	NEXT

;	2/

.L9814	DEFWORD	"2/"
	EQUW	L9806
.TSLAS	EQUW	*+2
	CLC
	LDA	1,X
	BPL	L9829
	INC	0,X
	BNE	L9826
	INC	1,X
.L9826	BEQ	L9829
	SEC
.L9829	ROR	1,X
	ROR	0,X
	JMP	NEXT

;	J

.L9830	DEFWORD	"J"
	EQUW	L9814
.JDO	EQUW	DOCOL
	EQUW	RPAT
	EQUW	LIT,7
	EQUW	PLUS
	EQUW	AT
	EQUW	EXIT

;	BACK

.L9842	DEFWORD	"BACK"
	EQUW	L9830
.BACK	EQUW	DOCOL
	EQUW	HERE
	EQUW	SUBB
	EQUW	COMMA
	EQUW	EXIT

;	DO

.L9853	DEFIMM	"DO"
	EQUW	L9842
.DO	EQUW	DOCOL
	EQUW	COMP
	EQUW	XDO
	EQUW	HERE
	EQUW	LIT,3
	EQUW	EXIT

;	LOOP

.L9866	DEFIMM	"LOOP"
	EQUW	L9853
.LOOP	EQUW	DOCOL
	EQUW	LIT,3
	EQUW	QPAIR
	EQUW	COMP
	EQUW	XLOOP
	EQUW	BACK
	EQUW	EXIT

;	+LOOP

.L987D	DEFIMM	"+LOOP"
	EQUW	L9866
.PLOOP	EQUW	DOCOL
	EQUW	LIT,3
	EQUW	QPAIR
	EQUW	COMP
	EQUW	XPLOO
	EQUW	BACK
	EQUW	EXIT

;	IF

.L9895	DEFIMM	"IF"
	EQUW	L987D
.IFF	EQUW	DOCOL
	EQUW	COMP
	EQUW	ZBRAN
	EQUW	HERE
	EQUW	ZERO
	EQUW	COMMA
	EQUW	TWO
	EQUW	EXIT

;	THEN

.L98AA	DEFIMM	"THEN"
	EQUW	L9895
.THEN	EQUW	DOCOL
	EQUW	QCOMP
	EQUW	TWO
	EQUW	QPAIR
	EQUW	HERE
	EQUW	OVER
	EQUW	SUBB
	EQUW	SWAP
	EQUW	STORE
	EQUW	EXIT

;	ELSE

.L98C5	DEFIMM	"ELSE"
	EQUW	L98AA
.ELSE	EQUW	DOCOL
	EQUW	TWO
	EQUW	QPAIR
	EQUW	COMP
	EQUW	BRAN
	EQUW	HERE
	EQUW	ZERO
	EQUW	COMMA
	EQUW	SWAP
	EQUW	TWO
	EQUW	THEN
	EQUW	TWO
	EQUW	EXIT

;	BEGIN

.L98E6	DEFIMM	"BEGIN"
	EQUW	L98C5
.BEGIN	EQUW	DOCOL
	EQUW	QCOMP
	EQUW	HERE
	EQUW	ONE
	EQUW	EXIT

;	UNTIL

.L98F8	DEFIMM	"UNTIL"
	EQUW	L98E6
.UNTIL	EQUW	DOCOL
	EQUW	ONE
	EQUW	QPAIR
	EQUW	COMP
	EQUW	ZBRAN
	EQUW	BACK
	EQUW	EXIT

;	AGAIN

.L990E	DEFIMM	"AGAIN"
	EQUW	L98F8
.AGAIN	EQUW	DOCOL
	EQUW	ONE
	EQUW	QPAIR
	EQUW	COMP
	EQUW	BRAN
	EQUW	BACK
	EQUW	EXIT

;	WHILE

.L9924	DEFIMM	"WHILE"
	EQUW	L990E
.WHILE	EQUW	DOCOL
	EQUW	IFF
	EQUW	TWOP
	EQUW	EXIT

;	REPEAT

.L9934	DEFIMM	"REPEAT"
	EQUW	L9924
.REPEAT	EQUW	DOCOL
	EQUW	TOR
	EQUW	TOR
	EQUW	AGAIN
	EQUW	RFROM
	EQUW	RFROM
	EQUW	TWO
	EQUW	SUBB
	EQUW	THEN
	EQUW	EXIT

;	'

.L9951	DEFIMM	"'"
	EQUW	L9934
.TICK	EQUW	DOCOL
	EQUW	FIND
	EQUW	DUPP
	EQUW	ZEQU
	EQUW	ZERO
	EQUW	QERR
	EQUW	TWOP
	EQUW	LITER
	EQUW	EXIT

;	VLIST

.L9967	DEFWORD	"VLIST"
	EQUW	L9951
.VLIST	EQUW	DOCOL
	EQUW	LIT,128
	EQUW	OUT
	EQUW	STORE
	EQUW	CONT
	EQUW	AT
	EQUW	AT
	EQUW	OUT
	EQUW	AT
	EQUW	CSLL
	EQUW	GREAT
	EQUW	ZBRAN,$A
	EQUW	CRR
	EQUW	ZERO
	EQUW	OUT
	EQUW	STORE
	EQUW	DUPP
	EQUW	IDDOT
	EQUW	SPACE
	EQUW	SPACE
	EQUW	PFA
	EQUW	LFA
	EQUW	AT
	EQUW	DUPP
	EQUW	QTAB
	EQUW	ZBRAN,$1E
	EQUW	QTAB
	EQUW	NOT
	EQUW	ZBRAN,$FFFA
	EQUW	KEY
	EQUW	BLL
	EQUW	EQUAL
	EQUW	ZBRAN,8
	EQUW	MIN1
	EQUW	BRAN,4
	EQUW	ZERO
	EQUW	ANDD
	EQUW	ZEQU
	EQUW	ZBRAN,$FFB6
	EQUW	DROP
	EQUW	EXIT

;	NOVEC

.L99CF	DEFWORD	"NOVEC"
	EQUW	L9967
.NOVEC	EQUW	DOCOL
	EQUW	LIT,12
	EQUW	ERROR
	EQUW	EXIT

;	EXVEC:

.L99E1	DEFWORD	"EXVEC:"
	EQUW	L99CF
.XVEC	EQUW	DOCOL
	EQUW	CREAT
	EQUW	LIT,NOVEC
	EQUW	COMMA
	EQUW	PSCOD
.DOXVEC	JSR	DODOE
	EQUW	ATEXEC
	EQUW	EXIT

;	ASSIGN

.L99FD	DEFIMM	"ASSIGN"
	EQUW	L99E1
.ASSIGN	EQUW	DOCOL
	EQUW	TICK
	EQUW	EXIT

;	DOVEC

.L9A0C	DEFWORD	"DOVEC"
	EQUW	L99FD
.DOVEC	EQUW	DOCOL
	EQUW	CFA
	EQUW	SWAP
	EQUW	STORE
	EQUW	EXIT

;	TO-DO

.L9A1E	DEFIMM	"TO-DO"
	EQUW	L9A0C
.TODO	EQUW	DOCOL
	EQUW	TICK
	EQUW	STATE
	EQUW	AT
	EQUW	ZBRAN,4
	EQUW	COMP
	EQUW	DOVEC
	EQUW	EXIT

;	INITVECS

.L9A38	DEFWORD	"INITVECS"
	EQUW	L9A1E
.INIVEC	EQUW	DOCOL
	EQUW	QRSW
	EQUW	LIT,PUPDA
	EQUW	LIT,UPDAT+2
	EQUW	STORE
	EQUW	LIT,PEMIT
	EQUW	LIT,EMIT+2
	EQUW	STORE
	EQUW	LIT,PKEY
	EQUW	LIT,KEY+2
	EQUW	STORE
	EQUW	LIT,PCREAT
	EQUW	LIT,CREAT+2
	EQUW	STORE
	EQUW	LIT,PNUM
	EQUW	LIT,NUM+2
	EQUW	STORE
	EQUW	LIT,PABOR
	EQUW	LIT,ABORT+2
	EQUW	STORE
	EQUW	LIT,SMSG
	EQUW	LIT,MESS+2
	EQUW	STORE
	EQUW	EXIT

;	PRUNE

.L9A8F	DEFWORD	"PRUNE"
	EQUW	L9A38
.PRUNE	EQUW	DOCOL
	EQUW	VOCL
	EQUW	AT
	EQUW	DUPP
	EQUW	ZBRAN,$5A
	EQUW	DUPP
	EQUW	TWOSUB
	EQUW	CURR
	EQUW	STORE
	EQUW	SWAP
	EQUW	DUPP
	EQUW	ONESUB
	EQUW	TOR
	EQUW	LAST
	EQUW	RAT
	EQUW	OVER
	EQUW	ULESS
	EQUW	OVER
	EQUW	LIT,$8000
	EQUW	ULESS
	EQUW	ANDD
	EQUW	ZBRAN,$C
	EQUW	PFA
	EQUW	LFA
	EQUW	AT
	EQUW	BRAN,$FFE4
	EQUW	CURR
	EQUW	AT
	EQUW	STORE
	EQUW	RFROM
	EQUW	DROP
	EQUW	OVER
	EQUW	AT
	EQUW	SWAP
	EQUW	ROT
	EQUW	OVER
	EQUW	SWAP
	EQUW	ULESS
	EQUW	ZBRAN,8
	EQUW	OVER
	EQUW	VOCL
	EQUW	STORE
	EQUW	SWAP
	EQUW	BRAN,$FFA4
	EQUW	TDROP
	EQUW	FORTH
	EQUW	DEFIN
	EQUW	EXIT

;	FORGET

.L9B03	DEFWORD	"FORGET"
	EQUW	L9A8F
.FORG	EQUW	DOCOL
	EQUW	CURR
	EQUW	AT
	EQUW	AT
	EQUW	DFIND
	EQUW	ZEQU
	EQUW	LIT,24
	EQUW	QERR
	EQUW	DROP
	EQUW	TWOP
	EQUW	NFA
	EQUW	ZERO
	EQUW	PORIG
	EQUW	OVER
	EQUW	ULESS
	EQUW	OVER
	EQUW	FENCE
	EQUW	AT
	EQUW	ULESS
	EQUW	ORR
	EQUW	LIT,21
	EQUW	QERR
	EQUW	DUPP
	EQUW	DP
	EQUW	STORE
	EQUW	PRUNE
	EQUW	EXIT

;	DEPTH

.L9B46	DEFWORD	"DEPTH"
	EQUW	L9B03
.DEPTH	EQUW	DOCOL
	EQUW	SPAT
	EQUW	SZERO
	EQUW	AT
	EQUW	SUBB
	EQUW	NEGAT
	EQUW	TSLAS
	EQUW	EXIT

;	.S

.L9B5E	DEFWORD	".S"
	EQUW	L9B46
.DOTS	EQUW	DOCOL
	EQUW	CRR
	EQUW	DEPTH
	EQUW	ZBRAN,$1A
	EQUW	SPAT
	EQUW	SZERO
	EQUW	AT
	EQUW	TWOSUB
	EQUW	XDO
	EQUW	IDO
	EQUW	QUES
	EQUW	NEGTWO
	EQUW	XPLOO,$FFF8
	EQUW	BRAN,$B
	EQUW	PDOTQ
	EQUB	6,"EMPTY "
	EQUW	EXIT

;	PICK

.L9B90	DEFWORD	"PICK"
	EQUW	L9B5E
.PICK	EQUW	*+2
	SEC
	TYA
	SBC	0,X
	TYA
	SBC	1,X
	BPL	L9BB6
	ASL	0,X
	ROL	1,X
	CLC
	TXA
	ADC	0,X
	TAY
	LDA	0,Y
	PHA
	INY
	LDA	0,Y
	JMP	PUT

.L9BB6	JMP	POP

;	ROLL

.L9BB9	DEFWORD	"ROLL"
	EQUW	L9B90
.ROLL	EQUW	*+2
	SEC
	TYA
	SBC	0,X
	TYA
	SBC	1,X
	BPL	L9BF3
	ASL	0,X
	ROL	1,X
	CLC
	TXA
	ADC	0,X
	TAY
	LDA	0,Y
	PHA
	INY
	LDA	0,Y
	PHA
	STX	XSAVE
	TYA
	TAX
	DEX
.L9BE2	DEX
	LDA	0,X
	STA	0,Y
	DEY
	CPX	XSAVE
	BNE	L9BE2
	INX
	INX
	PLA
	JMP	PUT

.L9BF3	JMP	POP

;	OSCLI

.L9BF6	DEFWORD	"OSCLI"
	EQUW	L9BB9
.OSCLI	EQUW	*+2
	STX	XSAVE
	LDY	1,X
	LDA	0,X
	TAX
	JSR	$FFF7
	LDX	XSAVE
	JMP	POP

;	STRING

.L9C0F	DEFWORD	"STRING"
	EQUW	L9BF6
.STRING	EQUW	DOCOL
	EQUW	MIN1
	EQUW	INN
	EQUW	PSTOR
	EQUW	PWORD
	EQUW	ONESUB
	EQUW	SWAP
	EQUW	OVER
	EQUW	ZBRAN,$A
	EQUW	ONEP
	EQUW	SWAP
	EQUW	BRAN,4
	EQUW	DROP
	EQUW	EXIT

;	($+)

.L9C38	DEFWORD	"($+)"
	EQUW	L9C0F
.PSA	EQUW	DOCOL
	EQUW	SWAP
	EQUW	TOR
	EQUW	SWAP
	EQUW	OVER
	EQUW	COUNT
	EQUW	DUPP
	EQUW	RAT
	EQUW	PLUS
	EQUW	LIT,5
	EQUW	ROLL
	EQUW	CSTOR
	EQUW	PLUS
	EQUW	RFROM
	EQUW	CMOVE
	EQUW	EXIT

;	(CLI)

.L9C61	DEFWORD	"(CLI)"
	EQUW	L9C38
.PCLI	EQUW	DOCOL
	EQUW	RAT
	EQUW	COUNT
	EQUW	ONEP
	EQUW	RFROM
	EQUW	PLUS
	EQUW	TOR
	EQUW	OSCLI
	EQUW	EXIT

;	>CLI

.L9C7B	DEFIMM	">CLI"
	EQUW	L9C61
.TOCLI	EQUW	DOCOL
	EQUW	STATE
	EQUW	AT
	EQUW	ZBRAN,$C
	EQUW	COMP
	EQUW	PCLI
	EQUW	TXTCOM
	EQUW	BRAN,6
	EQUW	DROP
	EQUW	OSCLI
	EQUW	EXIT

;	OS'

.L9C9C	DEFIMM	"OS'"
	EQUW	L9C7B
.OSTIC	EQUW	DOCOL
	EQUW	LIT,$27
	EQUW	STRING
	EQUW	QDUP
	EQUW	ZBRAN,$20
	EQUW	PAD
	EQUW	ZERO
	EQUW	OVER
	EQUW	STORE
	EQUW	PSA
	EQUW	LIT,$D
	EQUW	SPAT
	EQUW	ONE
	EQUW	PAD
	EQUW	PSA
	EQUW	DROP
	EQUW	PAD
	EQUW	COUNT
	EQUW	TOCLI
	EQUW	EXIT

;	KEY'

.L9CD0	DEFIMM	"KEY'"
	EQUW	L9C9C
.KEYTIC	EQUW	DOCOL
	EQUW	STATE
	EQUW	AT
	EQUW	ZBRAN,$2A
	EQUW	LIT,$FFFC
	EQUW	ALLOT
	EQUW	HERE
	EQUW	AT
	EQUW	LIT,LIT+2
	EQUW	CFA
	EQUW	SUBB
	EQUW	ZBRAN,$E
	EQUW	TWO
	EQUW	ALLOT
	EQUW	HERE
	EQUW	ATEXEC
	EQUW	BRAN,8
	EQUW	HERE
	EQUW	TWOP
	EQUW	CAT
	EQUW	ZERO
	EQUW	BDIG
	EQUW	LIT,'"'
	EQUW	HOLD
	EQUW	DIG
	EQUW	DIG
	EQUW	LIT,'Y'
	EQUW	HOLD
	EQUW	LIT,'E'
	EQUW	HOLD
	EQUW	LIT,'K'
	EQUW	HOLD
	EQUW	EDIG
	EQUW	PAD
	EQUW	TDUP
	EQUW	CSTOR
	EQUW	ONEP
	EQUW	SWAP
	EQUW	CMOVE
	EQUW	LIT,$27
	EQUW	STRING
	EQUW	QDUP
	EQUW	ZBRAN,6
	EQUW	PAD
	EQUW	PSA
	EQUW	LIT,$D22
	EQUW	SPAT
	EQUW	TWO
	EQUW	PAD
	EQUW	PSA
	EQUW	DROP
	EQUW	PAD
	EQUW	COUNT
	EQUW	TOCLI
	EQUW	EXIT

;	(OPEN)

.L9D5D	DEFWORD	"(OPEN)"
	EQUW	L9CD0
.POPEN	EQUW	*+2
	STX	XSAVE
	LDY	1,X
	LDA	0,X
	TAX
	LDA	#$C0
	JSR	$FFCE
	LDX	XSAVE
	STA	0,X
	LDY	#0
	STY	1,X
	JMP	NEXT

;	CLOSE

.L9D7F	DEFWORD	"CLOSE"
	EQUW	L9D5D
.CLOSE	EQUW	*+2
	TYA
	LDY	0,X
	JSR	$FFCE
	JMP	POP

;	(R/W)

.L9D92	DEFWORD	"(R/W)"
	EQUW	L9D7F
.PRSW	EQUW	*+2
	LDA	0,X
	INX
	INX
	INX
	STX	XSAVE
	JSR	$FFD1
	LDX	XSAVE
	INX
	JMP	POPTWO

;	OPEN

.L9DAC	DEFWORD	"OPEN"
	EQUW	LA093-REL
.OPEN	EQUW	DOCOL
	EQUW	POPEN
	EQUW	DUPP
	EQUW	ZEQU
	EQUW	ZBRAN,$C
	EQUW	ZERO
	EQUW	CLOSE
	EQUW	LIT,8
	EQUW	ERROR
	EQUW	CHANNE
	EQUW	CSTOR
	EQUW	EXIT

;	DR/W

.L9DCF	DEFWORD	"DR/W"
	EQUW	L9DAC
.DRSW	EQUW	DOCOL
	EQUW	TOR
	EQUW	SWAP
	EQUW	TOR
	EQUW	DUPP
	EQUW	ZLESS
	EQUW	LIT,6
	EQUW	QERR
	EQUW	SFILE
	EQUW	SLMOD
	EQUW	DUPP
	EQUW	MAXFIL
	EQUW	ONESUB
	EQUW	GREAT
	EQUW	LIT,6
	EQUW	QERR
	EQUW	LIT,'0'
	EQUW	PLUS
	EQUW	DUPP
	EQUW	LIT,'9'
	EQUW	GREAT
	EQUW	ZBRAN,8
	EQUW	LIT,7
	EQUW	PLUS
	EQUW	FNAME
	EQUW	CSTOR
	EQUW	FNAME
	EQUW	OPEN
	EQUW	ZERO
	EQUW	SWAP
	EQUW	BBUF
	EQUW	STAR
	EQUW	ZERO
	EQUW	BBUF
	EQUW	HIADR
	EQUW	RFROM
	EQUW	CHANNE
	EQUW	CAT
	EQUW	BSWAP
	EQUW	RFROM
	EQUW	TSTAR
	EQUW	ONEP
	EQUW	PRSW
	EQUW	CHANNE
	EQUW	CAT
	EQUW	CLOSE
	EQUW	LIT,9
	EQUW	QERR
	EQUW	DROP
	EQUW	TDROP
	EQUW	EXIT

;	EMPTY-BUFFERS

.L9E4A	DEFWORD	"EMPTY-BUFFERS"
	EQUW	LA0DD-REL
.MTBUF	EQUW	DOCOL
	EQUW	FIRST
	EQUW	LIMIT
	EQUW	OVER
	EQUW	SUBB
	EQUW	ERASE
	EQUW	FIRST
	EQUW	DUPP
	EQUW	USE
	EQUW	STORE
	EQUW	PREV
	EQUW	STORE
	EQUW	EXIT

;	SETBUF

.L9E74	DEFWORD	"SETBUF"
	EQUW	L9E4A
.SETBUF	EQUW	DOCOL
	EQUW	LIMIT
	EQUW	BUFSZ
	EQUW	NBUF
	EQUW	AT
	EQUW	STAR
	EQUW	SUBB
	EQUW	LIT,FIRST+2
	EQUW	STORE
	EQUW	EXIT

;	INITBUF

.L9E93	DEFWORD	"INITBUF"
	EQUW	L9E74
.INIBUF	EQUW	DOCOL
	EQUW	HIADR
	EQUW	MIN1
	EQUW	EQUAL
	EQUW	ZBRAN,8
	EQUW	HIMEM
	EQUW	BRAN,6
	EQUW	LIT,$8000
	EQUW	LIT,LIMIT+2
	EQUW	STORE
	EQUW	MINBUF
	EQUW	NBUF
	EQUW	STORE
	EQUW	SETBUF
	EQUW	MTBUF
	EQUW	EXIT

;	+BUF

.L9EC5	DEFWORD	"+BUF"
	EQUW	L9E93
.PBUF	EQUW	DOCOL
	EQUW	BUFSZ
	EQUW	PLUS
	EQUW	DUPP
	EQUW	LIMIT
	EQUW	EQUAL
	EQUW	ZBRAN,6
	EQUW	DROP
	EQUW	FIRST
	EQUW	DUPP
	EQUW	PREV
	EQUW	AT
	EQUW	SUBB
	EQUW	EXIT

;	(UPDATE)

.L9EEA	DEFWORD	"(UPDATE)"
	EQUW	L9EC5
.PUPDA	EQUW	DOCOL
	EQUW	PREV
	EQUW	AT
	EQUW	AT
	EQUW	LIT,$8000
	EQUW	ORR
	EQUW	PREV
	EQUW	AT
	EQUW	STORE
	EQUW	EXIT

;	BUFFER

.L9F0B	DEFWORD	"BUFFER"
	EQUW	LA0E8-REL
.BUFFE	EQUW	DOCOL
	EQUW	USE
	EQUW	AT
	EQUW	DUPP
	EQUW	TOR
	EQUW	PBUF
	EQUW	ZBRAN,$FFFC
	EQUW	USE
	EQUW	STORE
	EQUW	RAT
	EQUW	AT
	EQUW	ZLESS
	EQUW	ZBRAN,$14
	EQUW	RAT
	EQUW	TWOP
	EQUW	RAT
	EQUW	AT
	EQUW	LIT,$7FFF
	EQUW	ANDD
	EQUW	ZERO
	EQUW	RSW
	EQUW	RAT
	EQUW	STORE
	EQUW	RAT
	EQUW	PREV
	EQUW	STORE
	EQUW	RFROM
	EQUW	TWOP
	EQUW	EXIT

;	BLOCK

.L9F54	DEFWORD	"BLOCK"
	EQUW	L9F0B
.BLOCK	EQUW	DOCOL
	EQUW	OFFSE
	EQUW	AT
	EQUW	PLUS
	EQUW	TOR
	EQUW	PREV
	EQUW	AT
	EQUW	DUPP
	EQUW	AT
	EQUW	RAT
	EQUW	SUBB
	EQUW	TSTAR
	EQUW	ZBRAN,$30
	EQUW	PBUF
	EQUW	ZEQU
	EQUW	ZBRAN,$12
	EQUW	DROP
	EQUW	RAT
	EQUW	BUFFE
	EQUW	DUPP
	EQUW	RAT
	EQUW	ONE
	EQUW	RSW
	EQUW	TWOSUB
	EQUW	DUPP
	EQUW	AT
	EQUW	RAT
	EQUW	SUBB
	EQUW	TSTAR
	EQUW	ZEQU
	EQUW	ZBRAN,$FFDA
	EQUW	DUPP
	EQUW	PREV
	EQUW	STORE
	EQUW	RFROM
	EQUW	DROP
	EQUW	TWOP
	EQUW	USE
	EQUW	AT
	EQUW	PREV
	EQUW	AT
	EQUW	EQUAL
	EQUW	ZBRAN,$E
	EQUW	USE
	EQUW	AT
	EQUW	PBUF
	EQUW	DROP
	EQUW	USE
	EQUW	STORE
	EQUW	EXIT

;	LOAD

.L9FC8	DEFWORD	"LOAD"
	EQUW	L9F54
.LOAD	EQUW	DOCOL
	EQUW	BLK
	EQUW	AT
	EQUW	TOR
	EQUW	INN
	EQUW	AT
	EQUW	TOR
	EQUW	ZERO
	EQUW	INN
	EQUW	STORE
	EQUW	BSCR
	EQUW	STAR
	EQUW	BLK
	EQUW	STORE
	EQUW	INTE
	EQUW	RFROM
	EQUW	INN
	EQUW	STORE
	EQUW	RFROM
	EQUW	BLK
	EQUW	STORE
	EQUW	EXIT

; START OF BLOCK RELOCATED TO RAM

IF	KEEP_IN_ROM=TRUE

REL	=	0

ELSE

REL	=	*-RAM

ENDIF

;	EMIT

.L9FFB	DEFWORD	"EMIT"
	EQUW	L846A
.XEMIT	EQUW	DOXVEC
	EQUW	PEMIT

EMIT	=	XEMIT-REL

;	KEY

.LA006	DEFWORD	"KEY"
	EQUW	L85D7
.XKEY	EQUW	DOXVEC
	EQUW	PKEY

KEY	=	XKEY-REL

;	FIRST

.LA010	DEFWORD	"FIRST"
	EQUW	L89D6
.XFIRS	EQUW	DOCON
	EQUW	BUF1

FIRST	=	XFIRS-REL

;	LIMIT

.LA01C	DEFWORD	"LIMIT"
	EQUW	LA010-REL
.XLIMI	EQUW	DOCON
	EQUW	EM

LIMIT	=	XLIMI-REL

;	CREATE

.LA028	DEFWORD	"CREATE"
	EQUW	L914F
.XCREA	EQUW	DOXVEC
	EQUW	PCREAT

CREAT	=	XCREA-REL

;	NUM

.LA035	DEFWORD	"NUM"
	EQUW	L92F9
.XNUM	EQUW	DOXVEC
	EQUW	PNUM

NUM	=	XNUM-REL

;	FORTH

.LA03F	DEFIMM	"FORTH"
	EQUW	L9365
.XFORT	EQUW	DOVOC
	EQUW	$A081
	EQUW	TOPNFA
.VL0	EQUW	0

FORTH	=	XFORT-REL

;	ABORT

.LA04F	DEFWORD	"ABORT"
	EQUW	L9403
.XABOR	EQUW	DOXVEC
	EQUW	PABOR

ABORT	=	XABOR-REL

;	MESSAGE

.LA05B	DEFWORD	"MESSAGE"
	EQUW	L97EA
.XMES	EQUW	DOXVEC
	EQUW	SMSG

MESS	=	XMES-REL

;	S/FILE

.LA069	DEFWORD	"S/FILE"
	EQUW	L9D92
.XSFIL	EQUW	DOCON
	EQUW	9

SFILE	=	XSFIL-REL

;	MAXFILES

.LA076	DEFWORD	"MAXFILES"
	EQUW	LA069-REL
.XMAXFI	EQUW	DOCON
	EQUW	20

MAXFIL	=	XMAXFI-REL

;	CHANNEL

.LA085	DEFWORD	"CHANNEL"
	EQUW	LA076-REL
.XCHANN	EQUW	DOVAR
	EQUW	18

CHANNE	=	XCHANN-REL

;	FNAME

.LA093	DEFWORD	"FNAME"
	EQUW	LA085-REL
.XFNAM	EQUW	DOVAR
	EQUB	"1SCREEN",$D

FNAME	=	XFNAM-REL

;	R/W

.LA0A5	DEFWORD	"R/W"
	EQUW	L9DCF
.XRSW	EQUW	DOXVEC
	EQUW	DRSW

RSW	=	XRSW-REL

;	MINBUF

.LA0AF	DEFWORD	"MINBUF"
	EQUW	LA0A5-REL
.XMINBU	EQUW	DOCON
	EQUW	NOBUF

MINBUF	=	XMINBU-REL

;	BUFSZ

.LA0BC	DEFWORD	"BUFSZ"
	EQUW	LA0AF-REL
.XBUFS	EQUW	DOCON
	EQUW	HDBT

BUFSZ	=	XBUFS-REL

;	USE

.LA0C8	DEFWORD	"USE"
	EQUW	LA0BC-REL
.XUSE	EQUW	DOVAR
	EQUW	BUF1

USE	=	XUSE-REL

;	PREV

.LA0D2	DEFWORD	"PREV"
	EQUW	LA0C8-REL
.XPRE	EQUW	DOVAR
	EQUW	BUF1+HDBT

PREV	=	XPRE-REL

;	#BUF

.LA0DD	DEFWORD	"#BUF"
	EQUW	LA0D2-REL
.XNBU	EQUW	DOVAR
	EQUW	NOBUF

NBUF	=	XNBU-REL

;	UPDATE

.LA0E8	DEFWORD	"UPDATE"
	EQUW	L9EEA
.XUPDA	EQUW	DOXVEC
	EQUW	PUPDA

UPDAT	=	XUPDA-REL

;	(DISK)

.LA0F5	DEFWORD	"(DISK)"
	EQUW	L9FC8
.XPDIS	EQUW	DOCOL
	EQUW	PCLI
	EQUB	5,"DISK",$D
	EQUW	EXIT

PDISK	=	XPDIS-REL

;	TLD

.LA10A	DEFWORD	"TLD"
	EQUW	LA274
.XTLD	EQUW	DOCOL
	EQUW	PCLI
	EQUB	16
	EQUB	"LOAD"""
.LA11A	EQUB	"XXXX"" "
.LA120	EQUB	"YYYY",$D
	EQUW	EXIT

TLD	=	XTLD-REL

;	TSV

.LA127	DEFWORD	"TSV"
	EQUW	LA10A-REL
.XTSV	EQUW	DOCOL
	EQUW	PCLI
	EQUB	21,"SAVE""XXXX"" YYYY ZZZZ",$D
	EQUW	EXIT

TSV	=	XTSV-REL

;	SSV

.LA149	DEFWORD	"SSV"
	EQUW	LA127-REL
.XSSV	EQUW	DOCOL
	EQUW	PCLI
	EQUB	24
	EQUB	"SAVE"""
.LA159	EQUB	"XSCREEN"" "
.LA162	EQUB	"XXXX "
.LA167	EQUB	"YYYY",$D
	EQUW	EXIT

SSV	=	XSSV-REL

;	ASSEMBLER

.LA16E	DEFIMM	"ASSEMBLER"
	EQUW	LA4F6
.XASSE	EQUW	DOVOC
	EQUW	$A081
	EQUW	LAB1C
.LA180	EQUW	VL0-REL

ASSEM	=	XASSE-REL

;	MODE

.LA182	DEFWORD	"MODE"
	EQUW	LA5C7
.XMOD	EQUW	DOVAR
	EQUW	2

AMODE	=	XMOD-REL

;	EDITOR

.LA18D	DEFIMM	"EDITOR"
	EQUW	LAB39
.XEDIT	EQUW	DOVOC
	EQUW	$A081
	EQUW	LAFEC
	EQUW	LA180-REL
	EQUB	0

EDITOR	=	XEDIT-REL

; END OF BLOCK RELOCATED TO RAM

;	DISK

.LA19F	DEFWORD	"DISK"
	EQUW	LA0F5-REL
.DISK	EQUW	DOCOL
	EQUW	HIADR
	EQUW	MIN1
	EQUW	EQUAL
	EQUW	ZBRAN,$10
	EQUW	PAGE
	EQUW	LIT,$1900
	EQUW	ULESS
	EQUW	LIT,25
	EQUW	QERR
	EQUW	LIT,RSW+2
	EQUW	LIT,DRSW+2
	EQUW	DOVEC
	EQUW	PDISK
	EQUW	EXIT

;	SAVE-BUFFERS

.LA1CE	DEFWORD	"SAVE-BUFFERS"
	EQUW	LA19F
.SAVBUF	EQUW	DOCOL
	EQUW	FIRST
	EQUW	LIMIT
	EQUW	FIRST
	EQUW	SUBB
	EQUW	BUFSZ
	EQUW	SLASH
	EQUW	ZERO
	EQUW	XDO
	EQUW	DUPP
	EQUW	AT
	EQUW	ZLESS
	EQUW	ZBRAN,$1C
	EQUW	DUPP
	EQUW	AT
	EQUW	LIT,$7FFF
	EQUW	ANDD
	EQUW	OVER
	EQUW	STORE
	EQUW	DUPP
	EQUW	TWOP
	EQUW	OVER
	EQUW	AT
	EQUW	ZERO
	EQUW	RSW
	EQUW	BUFSZ
	EQUW	PLUS
	EQUW	XLOOP,$FFD6
	EQUW	DROP
	EQUW	EXIT

;	FLUSH

.LA21F	DEFWORD	"FLUSH"
	EQUW	LA1CE
.FLUSH	EQUW	DOCOL
	EQUW	SAVBUF
	EQUW	MTBUF
	EQUW	EXIT

;	-->

.LA22F	DEFIMM	"-->"
	EQUW	LA21F
.ARROW	EQUW	DOCOL
	EQUW	QLOAD
	EQUW	ZERO
	EQUW	INN
	EQUW	STORE
	EQUW	BSCR
	EQUW	BLK
	EQUW	AT
	EQUW	OVER
	EQUW	MOD
	EQUW	SUBB
	EQUW	BLK
	EQUW	PSTOR
	EQUW	EXIT

;	(LINE)

.LA251	DEFWORD	"(LINE)"
	EQUW	LA22F
.PLINE	EQUW	DOCOL
	EQUW	TOR
	EQUW	CSLL
	EQUW	BBUF
	EQUW	SSLMOD
	EQUW	RFROM
	EQUW	BSCR
	EQUW	STAR
	EQUW	PLUS
	EQUW	BLOCK
	EQUW	PLUS
	EQUW	CSLL
	EQUW	EXIT

;	.LINE

.LA274	DEFWORD	".LINE"
	EQUW	LA251
.DOTLIN	EQUW	DOCOL
	EQUW	PLINE
	EQUW	DTRAI
	EQUW	TYPE
	EQUW	EXIT

;	4HEX

.LA286	DEFWORD	"4HEX"
	EQUW	LA149-REL
.FHEX	EQUW	DOCOL
	EQUW	BASE
	EQUW	AT
	EQUW	HEX
	EQUW	SWAP
	EQUW	ZERO
	EQUW	BDIG
	EQUW	DIG
	EQUW	DIG
	EQUW	DIG
	EQUW	DIG
	EQUW	EDIG
	EQUW	ROT
	EQUW	BASE
	EQUW	STORE
	EQUW	EXIT

;	TR

.LA2AD	DEFWORD	"TR"
	EQUW	LA286
.TR	EQUW	DOCOL
	EQUW	FHEX
	EQUW	LIT,TLD+2
	EQUW	LIT,8
	EQUW	PLUS
	EQUW	SWAP
	EQUW	CMOVE
	EQUW	FHEX
	EQUW	LIT,TLD+2
	EQUW	LIT,$E
	EQUW	PLUS
	EQUW	SWAP
	EQUW	CMOVE
	EQUW	TLD
	EQUW	EXIT

;	TW

.LA2D8	DEFWORD	"TW"
	EQUW	LA2AD
.TW	EQUW	DOCOL
	EQUW	FHEX
	EQUW	LIT,TSV+2
	EQUW	LIT,8
	EQUW	PLUS
	EQUW	SWAP
	EQUW	CMOVE
	EQUW	DUPP
	EQUW	FHEX
	EQUW	LIT,TSV+2
	EQUW	LIT,$E
	EQUW	PLUS
	EQUW	SWAP
	EQUW	CMOVE
	EQUW	BBUF
	EQUW	PLUS
	EQUW	FHEX
	EQUW	LIT,TSV+2
	EQUW	LIT,$13
	EQUW	PLUS
	EQUW	SWAP
	EQUW	CMOVE
	EQUW	TSV
	EQUW	EXIT

;	TR/W

.LA319	DEFWORD	"TR/W"
	EQUW	LA2D8
.TRSW	EQUW	DOCOL
	EQUW	ZBRAN,8
	EQUW	TR
	EQUW	BRAN,4
	EQUW	TW
	EQUW	EXIT

;	?R/W

.LA330	DEFWORD	"?R/W"
	EQUW	LA319
.QRSW	EQUW	DOCOL
	EQUW	QFILE
	EQUW	LIT,3
	EQUW	LESS
	EQUW	ZBRAN,$10
	EQUW	LIT,RSW+2
	EQUW	LIT,TRSW+2
	EQUW	DOVEC
	EQUW	BRAN,$C
	EQUW	LIT,RSW+2
	EQUW	LIT,DRSW+2
	EQUW	DOVEC
	EQUW	EXIT

;	TAPE

.LA35F	DEFWORD	"TAPE"
	EQUW	LA330
.TAPE	EQUW	DOCOL
	EQUW	PCLI
	EQUB	5,"TAPE",$D
	EQUW	LIT,RSW+2
	EQUW	LIT,TRSW+2
	EQUW	DOVEC
	EQUW	EXIT

;	CREATE-SCREENS

.LA37C	DEFWORD	"CREATE-SCREENS"
	EQUW	LA35F
.CRESCR	EQUW	DOCOL
	EQUW	QFILE
	EQUW	LIT,4
	EQUW	LESS
	EQUW	ZBRAN,$E
	EQUW	PDOTQ
	EQUB	7,"No disk"
	EQUW	ABORT
	EQUW	HERE
	EQUW	DUPP
	EQUW	BBUF
	EQUW	BSCR
	EQUW	SFILE
	EQUW	STAR
	EQUW	STAR
	EQUW	TDUP
	EQUW	PLUS
	EQUW	FIRST
	EQUW	OVER
	EQUW	ULESS
	EQUW	LIT,25
	EQUW	QERR
	EQUW	PDOTQ
	EQUB	20,"Are you sure (Y/N)? "
	EQUW	KEY
	EQUW	LIT,'Y'
	EQUW	EQUAL
	EQUW	ZBRAN,$6A
	EQUW	FHEX
	EQUW	LIT,LA167-REL
	EQUW	SWAP
	EQUW	CMOVE
	EQUW	BLANKS
	EQUW	FHEX
	EQUW	LIT,LA162-REL
	EQUW	SWAP
	EQUW	CMOVE
	EQUW	CRR
	EQUW	PDOTQ
	EQUB	17,"Creating screens "
	EQUW	LIT,$2F
	EQUW	FNAME
	EQUW	CSTOR
	EQUW	MAXFIL
	EQUW	ZERO
	EQUW	XDO
	EQUW	FNAME
	EQUW	CAT
	EQUW	ONEP
	EQUW	DUPP
	EQUW	LIT,$3A
	EQUW	EQUAL
	EQUW	ZBRAN,8
	EQUW	LIT,7
	EQUW	PLUS
	EQUW	DUPP
	EQUW	FNAME
	EQUW	CSTOR
	EQUW	LIT,LA159-REL
	EQUW	CSTOR
	EQUW	SSV
	EQUW	XLOOP,$FFD8
	EQUW	BRAN,6
	EQUW	TDROP
	EQUW	TDROP
	EQUW	EXIT

;	LIST

.LA456	DEFWORD	"LIST"
	EQUW	LA37C
.LIST	EQUW	DOCOL
	EQUW	DECIM
	EQUW	CRR
	EQUW	DUPP
	EQUW	SCR
	EQUW	STORE
	EQUW	DUPP
	EQUW	BLOCK
	EQUW	DROP
	EQUW	PDOTQ
	EQUB	6,"SCR # "
	EQUW	DUPP
	EQUW	DOT
	EQUW	LIT,5
	EQUW	SPACS
	EQUW	HDOT
	EQUW	PDOTQ
	EQUB	1,'H'
	EQUW	LIT,16
	EQUW	ZERO
	EQUW	XDO
	EQUW	CRR
	EQUW	IDO
	EQUW	LIT,3
	EQUW	DOTR
	EQUW	SPACE
	EQUW	IDO
	EQUW	SCR
	EQUW	AT
	EQUW	DOTLIN
	EQUW	XLOOP,$FFEA
	EQUW	CRR
	EQUW	EXIT

;	79-STANDARD

.LA4AC	DEFWORD	"79-STANDARD"
	EQUW	LA456
.STD79	EQUW	DOCOL
	EQUW	EXIT

;	INDEX

.LA4BE	DEFWORD	"INDEX"
	EQUW	LA4AC
.INDEX	EQUW	DOCOL
	EQUW	LIT,$C
	EQUW	EMIT
	EQUW	CRR
	EQUW	ONEP
	EQUW	SWAP
	EQUW	XDO
	EQUW	CRR
	EQUW	IDO
	EQUW	LIT,3
	EQUW	DOTR
	EQUW	SPACE
	EQUW	ZERO
	EQUW	IDO
	EQUW	DOTLIN
	EQUW	QTAB
	EQUW	ZBRAN,4
	EQUW	LEAV
	EQUW	XLOOP,$FFE4
	EQUW	EXIT

;	TRIAD

.LA4F6	DEFWORD	"TRIAD"
	EQUW	LA4BE
.TRIAD	EQUW	DOCOL
	EQUW	LIT,$C
	EQUW	EMIT
	EQUW	LIT,3
	EQUW	SLASH
	EQUW	LIT,3
	EQUW	STAR
	EQUW	LIT,3
	EQUW	OVER
	EQUW	PLUS
	EQUW	SWAP
	EQUW	XDO
	EQUW	CRR
	EQUW	IDO
	EQUW	LIST
	EQUW	XLOOP,$FFF8
	EQUW	CRR
	EQUW	EXIT

;	?CURRENT

.LA52C	DEFWORD	"?CURRENT"
	EQUW	LA16E-REL
.QCURR	EQUW	DOCOL
	EQUW	TWOP
	EQUW	CURR
	EQUW	AT
	EQUW	SUBB
	EQUW	LIT,14
	EQUW	QERR
	EQUW	EXIT

;	N

.LA549	DEFWORD	"N"
	EQUW	FORTH+2
.ANN	EQUW	DOCON
	EQUW	N

;	XSAVE

.LA551	DEFWORD	"XSAVE"
	EQUW	LA549
.XSAV	EQUW	DOCON
	EQUW	XSAVE

;	W

.LA55D	DEFWORD	"W"
	EQUW	LA551
.AWW	EQUW	DOCON
	EQUW	W

;	IP

.LA565	DEFWORD	"IP"
	EQUW	LA55D
.AIP	EQUW	DOCON
	EQUW	IP

;	UP

.LA56E	DEFWORD	"UP"
	EQUW	LA565
.AUP	EQUW	DOCON
	EQUW	UP

;	PUSH

.LA577	DEFWORD	"PUSH"
	EQUW	LA56E
.APUSH	EQUW	DOCON
	EQUW	PUSH

;	PUT

.LA582	DEFWORD	"PUT"
	EQUW	LA577
.APUT	EQUW	DOCON
	EQUW	PUT

;	NEXT

.LA58C	DEFWORD	"NEXT"
	EQUW	LA582
.ANEXT	EQUW	DOCON
	EQUW	NEXT

;	SETUP

.LA597	DEFWORD	"SETUP"
	EQUW	LA58C
.ASETU	EQUW	DOCON
	EQUW	SETUP

;	POPTWO

.LA5A3	DEFWORD	"POPTWO"
	EQUW	LA597
.APOPTW	EQUW	DOCON
	EQUW	POPTWO

;	POP

.LA5B0	DEFWORD	"POP"
	EQUW	LA5A3
.APOP	EQUW	DOCON
	EQUW	POP

;	PUSH0A

.LA5BA	DEFWORD	"PUSH0A"
	EQUW	LA5B0
.APUSH0	EQUW	DOCON
	EQUW	L842B

;	BASE-ADDR

.LA5C7	DEFWORD	"BASE-ADDR"
	EQUW	LA5BA
.BASADR	EQUW	DOVAR
	EQUB	$09,$09,$05,$15,$15,$01,$11,$80
	EQUB	$09,$80,$0D,$1D,$19,$80,$80,$80
	EQUB	$80,$00,$04,$14,$14,$80,$80,$80
	EQUB	$80,$80,$0C,$1C,$1C,$80,$80,$2C

;	.A

.LA5F5	DEFWORD	".A"
	EQUW	LA182-REL
.DOTA	EQUW	DOCOL
	EQUW	ZERO
	EQUW	AMODE
	EQUW	STORE
	EQUW	EXIT

;	#

.LA604	DEFWORD	"#"
	EQUW	LA5F5
.ANUM	EQUW	DOCOL
	EQUW	ONE
	EQUW	AMODE
	EQUW	STORE
	EQUW	EXIT

;	MEM

.LA612	DEFWORD	"MEM"
	EQUW	LA604
.AMEM	EQUW	DOCOL
	EQUW	TWO
	EQUW	AMODE
	EQUW	STORE
	EQUW	EXIT

;	,X

.LA622	DEFWORD	",X"
	EQUW	LA612
.COMX	EQUW	DOCOL
	EQUW	LIT,3
	EQUW	AMODE
	EQUW	STORE
	EQUW	EXIT

;	,Y

.LA633	DEFWORD	",Y"
	EQUW	LA622
.COMY	EQUW	DOCOL
	EQUW	LIT,4
	EQUW	AMODE
	EQUW	STORE
	EQUW	EXIT

;	X)

.LA644	DEFWORD	"X)"
	EQUW	LA633
.XPAR	EQUW	DOCOL
	EQUW	LIT,5
	EQUW	AMODE
	EQUW	STORE
	EQUW	EXIT

;	)Y

.LA655	DEFWORD	")Y"
	EQUW	LA644
.PARY	EQUW	DOCOL
	EQUW	LIT,6
	EQUW	AMODE
	EQUW	STORE
	EQUW	EXIT

;	)

.LA666	DEFWORD	")"
	EQUW	LA655
.APAR	EQUW	DOCOL
	EQUW	LIT,$F
	EQUW	AMODE
	EQUW	STORE
	EQUW	EXIT

;	BOT

.LA676	DEFWORD	"BOT"
	EQUW	LA666
.ABOT	EQUW	DOCOL
	EQUW	COMX
	EQUW	ZERO
	EQUW	EXIT

;	SEC

.LA684	DEFWORD	"SEC"
	EQUW	LA676
.ASEC	EQUW	DOCOL
	EQUW	COMX
	EQUW	TWO
	EQUW	EXIT

;	RP)

.LA692	DEFWORD	"RP)"
	EQUW	LA684
.RPP	EQUW	DOCOL
	EQUW	COMX
	EQUW	LIT,$101
	EQUW	EXIT

;	CHKMODE

.LA6A2	DEFWORD	"CHKMODE"
	EQUW	LA692
.CHKMOD	EQUW	DOCOL
	EQUW	ZBRAN,$1A
	EQUW	AMODE
	EQUW	AT
	EQUW	LIT,8
	EQUW	ANDD
	EQUW	ZEQU
	EQUW	ZBRAN,$A
	EQUW	LIT,8
	EQUW	AMODE
	EQUW	PSTOR
	EQUW	ONE
	EQUW	AMODE
	EQUW	AT
	EQUW	LIT,$F
	EQUW	ANDD
	EQUW	QDUP
	EQUW	ZBRAN,$E
	EQUW	ZERO
	EQUW	XDO
	EQUW	DUPP
	EQUW	PLUS
	EQUW	XLOOP,$FFFA
	EQUW	OVER
	EQUW	ONEP
	EQUW	AT
	EQUW	ANDD
	EQUW	ZEQU
	EQUW	EXIT

;	SOP

.LA6F4	DEFWORD	"SOP"
	EQUW	LA6A2
.SOP	EQUW	DOCOL
	EQUW	CREAT
	EQUW	CCOMM
	EQUW	PSCOD
.DOSOP	JSR	DODOE
	EQUW	CAT
	EQUW	CCOMM
	EQUW	AMEM
	EQUW	EXIT

;	BRK,

.LA70D	DEFWORD	"BRK,"
	EQUW	LA6F4
	EQUW	DOSOP
	EQUB	0

;	CLC,

.LA717	DEFWORD	"CLC,"
	EQUW	LA70D
	EQUW	DOSOP
	EQUB	$18

;	CLD,

.LA721	DEFWORD	"CLD,"
	EQUW	LA717
	EQUW	DOSOP
	EQUB	$D8

;	CLI,

.LA72B	DEFWORD	"CLI,"
	EQUW	LA721
	EQUW	DOSOP
	EQUB	$58

;	CLV,

.LA735	DEFWORD	"CLV,"
	EQUW	LA72B
	EQUW	DOSOP
	EQUB	$B8

;	DEX,

.LA73F	DEFWORD	"DEX,"
	EQUW	LA735
	EQUW	DOSOP
	EQUB	$CA

;	DEY,

.LA749	DEFWORD	"DEY,"
	EQUW	LA73F
	EQUW	DOSOP
	EQUB	$88

;	INX,

.LA753	DEFWORD	"INX,"
	EQUW	LA749
	EQUW	DOSOP
	EQUB	$E8

;	INY,

.LA75D	DEFWORD	"INY,"
	EQUW	LA753
	EQUW	DOSOP
	EQUB	$C8

;	NOP,

.LA767	DEFWORD	"NOP,"
	EQUW	LA75D
	EQUW	DOSOP
	EQUB	$EA

;	PHA,

.LA771	DEFWORD	"PHA,"
	EQUW	LA767
	EQUW	DOSOP
	EQUB	$48

;	PHP,

.LA77B	DEFWORD	"PHP,"
	EQUW	LA771
	EQUW	DOSOP
	EQUB	8

;	PLA,

.LA785	DEFWORD	"PLA,"
	EQUW	LA77B
	EQUW	DOSOP
	EQUB	$68

;	PLP,

.LA78F	DEFWORD	"PLP,"
	EQUW	LA785
	EQUW	DOSOP
	EQUB	$28

;	RTI,

.LA799	DEFWORD	"RTI,"
	EQUW	LA78F
	EQUW	DOSOP
	EQUB	$40

;	RTS,

.LA7A3	DEFWORD	"RTS,"
	EQUW	LA799
	EQUW	DOSOP
	EQUB	$60

;	SEC,

.LA7AD	DEFWORD	"SEC,"
	EQUW	LA7A3
	EQUW	DOSOP
	EQUB	$38

;	SED,

.LA7B7	DEFWORD	"SED,"
	EQUW	LA7AD
	EQUW	DOSOP
	EQUB	$F8

;	SEI,

.LA7C1	DEFWORD	"SEI,"
	EQUW	LA7B7
	EQUW	DOSOP
	EQUB	$78

;	TAX,

.LA7CB	DEFWORD	"TAX,"
	EQUW	LA7C1
	EQUW	DOSOP
	EQUB	$AA

;	TAY,

.LA7D5	DEFWORD	"TAY,"
	EQUW	LA7CB
	EQUW	DOSOP
	EQUB	$A8

;	TSX,

.LA7DF	DEFWORD	"TSX,"
	EQUW	LA7D5
	EQUW	DOSOP
	EQUB	$BA

;	TXA,

.LA7E9	DEFWORD	"TXA,"
	EQUW	LA7DF
	EQUW	DOSOP
	EQUB	$8A

;	TXS,

.LA7F3	DEFWORD	"TXS,"
	EQUW	LA7E9
	EQUW	DOSOP
	EQUB	$9A

;	TYA,

.LA7FD	DEFWORD	"TYA,"
	EQUW	LA7F3
	EQUW	DOSOP
	EQUB	$98

;	MOP

.LA807	DEFWORD	"MOP"
	EQUW	LA7FD
.MOP	EQUW	DOCOL
	EQUW	CREAT
	EQUW	CCOMM
	EQUW	COMMA
	EQUW	PSCOD
.DOMOP	JSR	DODOE
	EQUW	DUPP
	EQUW	ONEP
	EQUW	AT
	EQUW	LIT,$80
	EQUW	ANDD
	EQUW	ZBRAN,$A
	EQUW	LIT,$10
	EQUW	AMODE
	EQUW	PSTOR
	EQUW	OVER
	EQUW	LIT,$FF00
	EQUW	ANDD
	EQUW	CHKMOD
	EQUW	CHKMOD
	EQUW	ZBRAN,$10
	EQUW	AMEM
	EQUW	CRR
	EQUW	LAST
	EQUW	IDDOT
	EQUW	LIT,3
	EQUW	ERROR
	EQUW	CAT
	EQUW	AMODE
	EQUW	CAT
	EQUW	BASADR
	EQUW	PLUS
	EQUW	CAT
	EQUW	PLUS
	EQUW	CCOMM
	EQUW	AMODE
	EQUW	CAT
	EQUW	LIT,7
	EQUW	ANDD
	EQUW	ZBRAN,$1E
	EQUW	AMODE
	EQUW	CAT
	EQUW	LIT,$F
	EQUW	ANDD
	EQUW	LIT,7
	EQUW	LESS
	EQUW	ZBRAN,8
	EQUW	CCOMM
	EQUW	BRAN,4
	EQUW	COMMA
	EQUW	AMEM
	EQUW	EXIT

;	ADC,

.LA88E	DEFWORD	"ADC,"
	EQUW	LA807
	EQUW	DOMOP
	EQUB	$60,$6E,$1C

;	AND,

.LA89A	DEFWORD	"AND,"
	EQUW	LA88E
	EQUW	DOMOP
	EQUB	$20,$6E,$1C

;	CMP,

.LA8A6	DEFWORD	"CMP,"
	EQUW	LA89A
	EQUW	DOMOP
	EQUB	$C0,$6E,$1C

;	EOR,

.LA8B2	DEFWORD	"EOR,"
	EQUW	LA8A6
	EQUW	DOMOP
	EQUB	$40,$6E,$1C

;	LDA,

.LA8BE	DEFWORD	"LDA,"
	EQUW	LA8B2
	EQUW	DOMOP
	EQUB	$A0,$6E,$1C

;	ORA,

.LA8CA	DEFWORD	"ORA,"
	EQUW	LA8BE
	EQUW	DOMOP
	EQUB	0,$6E,$1C

;	SBC,

.LA8D6	DEFWORD	"SBC,"
	EQUW	LA8CA
	EQUW	DOMOP
	EQUB	$E0,$6E,$1C

;	STA,

.LA8E2	DEFWORD	"STA,"
	EQUW	LA8D6
	EQUW	DOMOP
	EQUB	$80,$6C,$1C

;	ASL,

.LA8EE	DEFWORD	"ASL,"
	EQUW	LA8E2
	EQUW	DOMOP
	EQUB	1,$D,$D

;	DEC,

.LA8FA	DEFWORD	"DEC,"
	EQUW	LA8EE
	EQUW	DOMOP
	EQUB	$C1,$C,$C

;	INC,

.LA906	DEFWORD	"INC,"
	EQUW	LA8FA
	EQUW	DOMOP
	EQUB	$E1,$C,$C

;	LSR,

.LA912	DEFWORD	"LSR,"
	EQUW	LA906
	EQUW	DOMOP
	EQUB	$41,$D,$D

;	ROL,

.LA91E	DEFWORD	"ROL,"
	EQUW	LA912
	EQUW	DOMOP
	EQUB	$21,$D,$D

;	ROR,

.LA92A	DEFWORD	"ROR,"
	EQUW	LA91E
	EQUW	DOMOP
	EQUB	$61,$D,$D

;	STX,

.LA936	DEFWORD	"STX,"
	EQUW	LA92A
	EQUW	DOMOP
	EQUB	$81,$14,4

;	CPX,

.LA942	DEFWORD	"CPX,"
	EQUW	LA936
	EQUW	DOMOP
	EQUB	$E0,$86,4

;	CPY,

.LA94E	DEFWORD	"CPY,"
	EQUW	LA942
	EQUW	DOMOP
	EQUB	$C0,$86,4

;	LDX,

.LA95A	DEFWORD	"LDX,"
	EQUW	LA94E
	EQUW	DOMOP
	EQUB	$A2,$96,$14

;	LDY,

.LA966	DEFWORD	"LDY,"
	EQUW	LA95A
	EQUW	DOMOP
	EQUB	$A0,$8E,$C

;	STY,

.LA972	DEFWORD	"STY,"
	EQUW	LA966
	EQUW	DOMOP
	EQUB	$80,$8C,4

;	JSR,

.LA97E	DEFWORD	"JSR,"
	EQUW	LA972
	EQUW	DOMOP
	EQUB	$14,$80,4

;	JMP,

.LA98A	DEFWORD	"JMP,"
	EQUW	LA97E
.JMPP	EQUW	DOMOP
	EQUB	$40,$80,$84

;	BIT,

.LA996	DEFWORD	"BIT,"
	EQUW	LA98A
	EQUW	DOMOP
	EQUB	$20,$84,4

;	>BRANGE

.LA9A2	DEFWORD	">BRANGE"
	EQUW	LA996
.LA9AC	EQUW	DOCOL
	EQUW	DUPP
	EQUW	ZLESS
	EQUW	OVER
	EQUW	LIT,$7F
	EQUW	GREAT
	EQUW	ORR
	EQUW	LIT,13
	EQUW	QERR
	EQUW	EXIT

;	<BRANGE

.LA9C4	DEFWORD	"<BRANGE"
	EQUW	LA9A2
.LA9CE	EQUW	DOCOL
	EQUW	DUPP
	EQUW	ZGREA
	EQUW	OVER
	EQUW	LIT,$FF80
	EQUW	LESS
	EQUW	ORR
	EQUW	LIT,13
	EQUW	QERR
	EQUW	EXIT

;	0<

.LA9E6	DEFWORD	"0<"
	EQUW	LA9C4
.LA9EB	EQUW	DOCON
	EQUW	$10

;	VS

.LA9EF	DEFWORD	"VS"
	EQUW	LA9E6
.LA9F4	EQUW	DOCON
	EQUW	$50

;	CS

.LA9F8	DEFWORD	"CS"
	EQUW	LA9EF
.LA9FD	EQUW	DOCON
	EQUW	$90

;	0=

.LAA01	DEFWORD	"0="
	EQUW	LA9F8
.LAA06	EQUW	DOCON
	EQUW	$D0

;	NOT

.LAA0A	DEFWORD	"NOT"
	EQUW	LAA01
.LAA10	EQUW	DOCOL
	EQUW	LIT,$20
	EQUW	PLUS
	EQUW	EXIT

;	IF,

.LAA1A	DEFWORD	"IF,"
	EQUW	LAA0A
.AIF	EQUW	DOCOL
	EQUW	CCOMM
	EQUW	HERE
	EQUW	ZERO
	EQUW	CCOMM
	EQUW	TWO
	EQUW	EXIT

;	THEN,

.LAA2E	DEFWORD	"THEN,"
	EQUW	LAA1A
.ATHEN	EQUW	DOCOL
	EQUW	QEXEC
	EQUW	TWO
	EQUW	QPAIR
	EQUW	HERE
	EQUW	OVER
	EQUW	CAT
	EQUW	ZBRAN,$A
	EQUW	SWAP
	EQUW	STORE
	EQUW	BRAN,$E
	EQUW	OVER
	EQUW	ONEP
	EQUW	SUBB
	EQUW	LA9AC
	EQUW	SWAP
	EQUW	CSTOR
	EQUW	EXIT

;	ELSE,

.LAA5E	DEFWORD	"ELSE,"
	EQUW	LAA2E
.AELSE	EQUW	DOCOL
	EQUW	TWO
	EQUW	QPAIR
	EQUW	HERE
	EQUW	ONEP
	EQUW	ONE
	EQUW	JMPP
	EQUW	SWAP
	EQUW	HERE
	EQUW	OVER
	EQUW	ONEP
	EQUW	SUBB
	EQUW	LA9AC
	EQUW	SWAP
	EQUW	CSTOR
	EQUW	TWO
	EQUW	EXIT

;	BEGIN,

.LAA88	DEFWORD	"BEGIN,"
	EQUW	LAA5E
.ABEGIN	EQUW	DOCOL
	EQUW	HERE
	EQUW	ONE
	EQUW	EXIT

;	UNTIL,

.LAA99	DEFWORD	"UNTIL,"
	EQUW	LAA88
.AUNTIL	EQUW	DOCOL
	EQUW	QEXEC
	EQUW	SWAP
	EQUW	ONE
	EQUW	QPAIR
	EQUW	CCOMM
	EQUW	HERE
	EQUW	ONEP
	EQUW	SUBB
	EQUW	LA9CE
	EQUW	CCOMM
	EQUW	EXIT

;	AGAIN,

.LAABA	DEFWORD	"AGAIN,"
	EQUW	LAA99
.AAGAIN	EQUW	DOCOL
	EQUW	QEXEC
	EQUW	ONE
	EQUW	QPAIR
	EQUW	JMPP
	EQUW	EXIT

;	WHILE,

.LAACF	DEFWORD	"WHILE,"
	EQUW	LAABA
.AWHIL	EQUW	DOCOL
	EQUW	OVER
	EQUW	ONE
	EQUW	QPAIR
	EQUW	AIF
	EQUW	EXIT

;	REPEAT,

.LAAE4	DEFWORD	"REPEAT,"
	EQUW	LAACF
.AREPEA	EQUW	DOCOL
	EQUW	QEXEC
	EQUW	TWO
	EQUW	QPAIR
	EQUW	HERE
	EQUW	TWOP
	EQUW	OVER
	EQUW	SUBB
	EQUW	LA9AC
	EQUW	SWAP
	EQUW	CSTOR
	EQUW	AAGAIN
	EQUW	EXIT

;	MACRO

.LAB08	DEFWORD	"MACRO"
	EQUW	LAAE4
.MACRO	EQUW	DOCOL
	EQUW	LIT,ASSEM+2
	EQUW	QCURR
	EQUW	COLON
	EQUW	EXIT

;	END-CODE

.LAB1C	DEFIMM	"END-CODE"
	EQUW	LAB08
.ENDCOD	EQUW	DOCOL
	EQUW	CURR
	EQUW	AT
	EQUW	CONT
	EQUW	STORE
	EQUW	QEXEC
	EQUW	QCSP
	EQUW	SMUDG
	EQUW	EXIT

;	CODE

.LAB39	DEFIMM	"CODE"
	EQUW	LA52C
.CODE	EQUW	DOCOL
	EQUW	QEXEC
	EQUW	CREAT
	EQUW	HERE
	EQUW	HERE
	EQUW	TWOSUB
	EQUW	STORE
	EQUW	SMUDG
	EQUW	ASSEM
	EQUW	AMEM
	EQUW	SCSP
	EQUW	EXIT

;	LOCATE

.LAB58	DEFWORD	"LOCATE"
	EQUW	LA18D-REL
.LOCATE	EQUW	DOCOL
	EQUW	QFILE
	EQUW	LIT,4
	EQUW	LESS
	EQUW	ZBRAN,$28
	EQUW	ONESUB
	EQUW	HIADR
	EQUW	MIN1
	EQUW	EQUAL
	EQUW	ZBRAN,$A
	EQUW	LIT,$8000
	EQUW	BRAN,4
	EQUW	HERE
	EQUW	SWAP
	EQUW	ONE
	EQUW	RSW
	EQUW	LIT,7
	EQUW	TOVDU
	EQUW	BRAN,4
	EQUW	DROP
	EQUW	EXIT

;	SAVE

.LAB99	DEFWORD	"SAVE"
	EQUW	LAB58
.SAVE	EQUW	DOCOL
	EQUW	SCR
	EQUW	AT
	EQUW	LIST
	EQUW	CRR
	EQUW	PDOTQ
	EQUB	4,"OK? "
	EQUW	KEY
	EQUW	LIT,$59
	EQUW	EQUAL
	EQUW	ZBRAN,$A
	EQUW	PUPDA
	EQUW	SAVBUF
	EQUW	BRAN,4
	EQUW	QUIT
	EQUW	EXIT

;	CLRSCR

.LABC9	DEFWORD	"CLRSCR"
	EQUW	LAB99
.CLRSCR	EQUW	DOCOL
	EQUW	SCR
	EQUW	AT
	EQUW	DUPP
	EQUW	LIT,$8000
	EQUW	ANDD
	EQUW	LIT,6
	EQUW	QERR
	EQUW	DUPP
	EQUW	PREV
	EQUW	AT
	EQUW	DUPP
	EQUW	BUFSZ
	EQUW	TWOSUB
	EQUW	TDUP
	EQUW	PLUS
	EQUW	ZERO
	EQUW	SWAP
	EQUW	STORE
	EQUW	BLANKS
	EQUW	STORE
	EQUW	LIST
	EQUW	EXIT

;	PROGRAM

.LAC04	DEFWORD	"PROGRAM"
	EQUW	LABC9
.PROGRA	EQUW	DOCOL
	EQUW	CRR
	EQUW	PDOTQ
	EQUB	19,"1st screen number? "
	EQUW	QUERY
	EQUW	INTE
	EQUW	SCR
	EQUW	STORE
	EQUW	CLRSCR
	EQUW	EDITOR
	EQUW	EXIT

;	ANOTHER

.LAC36	DEFWORD	"ANOTHER"
	EQUW	LAC04
.ANOTHR	EQUW	DOCOL
	EQUW	ONE
	EQUW	SCR
	EQUW	PSTOR
	EQUW	CLRSCR
	EQUW	EXIT

;	MORE

.LAC4C	DEFWORD	"MORE"
	EQUW	LAC36
.MORE	EQUW	DOCOL
	EQUW	SAVE
	EQUW	ANOTHR
	EQUW	EXIT

;	TEXT

.LAC5B	DEFWORD	"TEXT"
	EQUW	LAC4C
.TEXT	EQUW	DOCOL
	EQUW	PAD
	EQUW	CSLL
	EQUW	TWOP
	EQUW	BLANKS
	EQUW	PWORD
	EQUW	CSLL
	EQUW	MIN
	EQUW	PAD
	EQUW	CSTOR
	EQUW	PAD
	EQUW	COUNT
	EQUW	CMOVE
	EQUW	EXIT

;	LINE

.LAC7E	DEFWORD	"LINE"
	EQUW	LAC5B
.LINE	EQUW	DOCOL
	EQUW	DUPP
	EQUW	LIT,$FFF0
	EQUW	ANDD
	EQUW	LIT,23
	EQUW	QERR
	EQUW	SCR
	EQUW	AT
	EQUW	PLINE
	EQUW	DROP
	EQUW	EXIT

;	WHERE

.LAC9F	DEFWORD	"WHERE"
	EQUW	LAC7E
.WHERE	EQUW	DOCOL
	EQUW	DUPP
	EQUW	BSCR
	EQUW	SLASH
	EQUW	DUPP
	EQUW	SCR
	EQUW	STORE
	EQUW	PDOTQ
	EQUB	6,"SCR # "
	EQUW	DECDOT
	EQUW	SWAP
	EQUW	CSLL
	EQUW	SLMOD
	EQUW	CSLL
	EQUW	STAR
	EQUW	ROT
	EQUW	BLOCK
	EQUW	PLUS
	EQUW	CRR
	EQUW	CSLL
	EQUW	TYPE
	EQUW	CRR
	EQUW	WBFR
	EQUW	CAT
	EQUW	SUBB
	EQUW	SPACS
	EQUW	LIT,$5E
	EQUW	EMIT
	EQUW	EDITOR
	EQUW	SPSTO
	EQUW	QUIT
	EQUW	EXIT

;	#LOCATE

.LACEE	DEFWORD	"#LOCATE"
	EQUW	FORTH+2
.NLOCAT	EQUW	DOCOL
	EQUW	RNUM
	EQUW	AT
	EQUW	CSLL
	EQUW	SLMOD
	EQUW	EXIT

;	#LEAD

.LAD04	DEFWORD	"#LEAD"
	EQUW	LACEE
.NLEAD	EQUW	DOCOL
	EQUW	NLOCAT
	EQUW	LINE
	EQUW	SWAP
	EQUW	EXIT

;	#LAG

.LAD16	DEFWORD	"#LAG"
	EQUW	LAD04
.LAG	EQUW	DOCOL
	EQUW	NLEAD
	EQUW	DUPP
	EQUW	TOR
	EQUW	PLUS
	EQUW	CSLL
	EQUW	RFROM
	EQUW	SUBB
	EQUW	EXIT

;	-MOVE

.LAD2F	DEFWORD	"-MOVE"
	EQUW	LAD16
.DMOVE	EQUW	DOCOL
	EQUW	LINE
	EQUW	CSLL
	EQUW	CMOVE
	EQUW	UPDAT
	EQUW	EXIT

;	H

.LAD43	DEFWORD	"H"
	EQUW	LAD2F
.HH	EQUW	DOCOL
	EQUW	LINE
	EQUW	PAD
	EQUW	ONEP
	EQUW	CSLL
	EQUW	DUPP
	EQUW	PAD
	EQUW	CSTOR
	EQUW	CMOVE
	EQUW	EXIT

;	E

.LAD5B	DEFWORD	"E"
	EQUW	LAD43
.EE	EQUW	DOCOL
	EQUW	LINE
	EQUW	CSLL
	EQUW	BLANKS
	EQUW	UPDAT
	EQUW	EXIT

;	S

.LAD6B	DEFWORD	"S"
	EQUW	LAD5B
.SS	EQUW	DOCOL
	EQUW	DUPP
	EQUW	LIT,$FFF0
	EQUW	ANDD
	EQUW	NOT
	EQUW	ZBRAN,$1A
	EQUW	DUPP
	EQUW	LIT,$E
	EQUW	XDO
	EQUW	IDO
	EQUW	LINE
	EQUW	IDO
	EQUW	ONEP
	EQUW	DMOVE
	EQUW	MIN1
	EQUW	XPLOO,$FFF2
	EQUW	EE
	EQUW	EXIT

;	D

.LAD9B	DEFWORD	"D"
	EQUW	LAD6B
.DD	EQUW	DOCOL
	EQUW	DUPP
	EQUW	HH
	EQUW	DUPP
	EQUW	LIT,$F
	EQUW	SUBB
	EQUW	ZBRAN,$1A
	EQUW	LIT,$F
	EQUW	DUPP
	EQUW	ROT
	EQUW	XDO
	EQUW	IDO
	EQUW	ONEP
	EQUW	LINE
	EQUW	IDO
	EQUW	DMOVE
	EQUW	XLOOP,$FFF4
	EQUW	EE
	EQUW	EXIT

;	M

.LADCD	DEFWORD	"M"
	EQUW	LAD9B
.EMM	EQUW	DOCOL
	EQUW	RNUM
	EQUW	PSTOR
	EQUW	CRR
	EQUW	SPACE
	EQUW	NLEAD
	EQUW	TYPE
	EQUW	LIT,$7C
	EQUW	EMIT
	EQUW	LAG
	EQUW	TYPE
	EQUW	NLOCAT
	EQUW	DOT
	EQUW	DROP
	EQUW	EXIT

;	T

.LADF1	DEFWORD	"T"
	EQUW	LADCD
.TT	EQUW	DOCOL
	EQUW	DUPP
	EQUW	CSLL
	EQUW	STAR
	EQUW	RNUM
	EQUW	STORE
	EQUW	HH
	EQUW	ZERO
	EQUW	EMM
	EQUW	EXIT

;	L

.LAE09	DEFWORD	"L"
	EQUW	LADF1
.LL	EQUW	DOCOL
	EQUW	SCR
	EQUW	AT
	EQUW	LIST
	EQUW	ZERO
	EQUW	EMM
	EQUW	EXIT

;	R

.LAE1B	DEFWORD	"R"
	EQUW	LAE09
.RR	EQUW	DOCOL
	EQUW	PAD
	EQUW	ONEP
	EQUW	SWAP
	EQUW	DMOVE
	EQUW	EXIT

;	P

.LAE2B	DEFWORD	"P"
	EQUW	LAE1B
.PP	EQUW	DOCOL
	EQUW	ONE
	EQUW	TEXT
	EQUW	RR
	EQUW	EXIT

;	I

.LAE39	DEFWORD	"I"
	EQUW	LAE2B
.II	EQUW	DOCOL
	EQUW	DUPP
	EQUW	SS
	EQUW	RR
	EQUW	EXIT

;	TOP

.LAE47	DEFWORD	"TOP"
	EQUW	LAE39
.TOPP	EQUW	DOCOL
	EQUW	ZERO
	EQUW	RNUM
	EQUW	STORE
	EQUW	EXIT

;	CLEAR

.LAE57	DEFWORD	"CLEAR"
	EQUW	LAE47
.CLEAR	EQUW	DOCOL
	EQUW	SCR
	EQUW	STORE
	EQUW	LIT,16
	EQUW	ZERO
	EQUW	XDO
	EQUW	IDO
	EQUW	EE
	EQUW	XLOOP,$FFFA
	EQUW	EXIT

;	COPY

.LAE77	DEFWORD	"COPY"
	EQUW	LAE57
.COPY	EQUW	DOCOL
	EQUW	BSCR
	EQUW	STAR
	EQUW	OFFSE
	EQUW	AT
	EQUW	PLUS
	EQUW	SWAP
	EQUW	BSCR
	EQUW	STAR
	EQUW	BSCR
	EQUW	OVER
	EQUW	PLUS
	EQUW	SWAP
	EQUW	XDO
	EQUW	DUPP
	EQUW	IDO
	EQUW	BLOCK
	EQUW	TWOSUB
	EQUW	STORE
	EQUW	ONEP
	EQUW	UPDAT
	EQUW	XLOOP,$FFF0
	EQUW	DROP
	EQUW	SAVBUF
	EQUW	EXIT

;	MATCH

.LAEB2	DEFWORD	"MATCH"
	EQUW	LAE77
.MATCH	EQUW	*+2
	LDA	#4
	JSR	SETUP
	DEX
	DEX
	DEX
	DEX
	STY	0,X
	STY	1,X
.LAEC9	LDY	#$FF
.LAECB	INY
	CPY	N
	BCS	LAEFC
	LDA	(N+2),Y
	CMP	($66),Y
	BEQ	LAECB
	INC	$66
	BNE	LAEDC
	INC	$67
.LAEDC	INC	0,X
	BNE	LAEE2
	INC	1,X
.LAEE2	LDA	N+4
	BNE	LAEE8
	DEC	N+5
.LAEE8	DEC	N+4
	LDA	N+4
	CMP	N
	LDA	N+5
	SBC	N+1
	BCS	LAEC9
	LDA	#0
	STA	2,X
	STA	3,X
	LDY	N+4
.LAEFC	CLC
	TYA
	ADC	0,X
	PHA
	LDA	#0
	ADC	1,X
	JMP	PUT

;	1LINE

.LAF08	DEFWORD	"1LINE"
	EQUW	LAEB2
.ONELIN	EQUW	DOCOL
	EQUW	LAG
	EQUW	PAD
	EQUW	COUNT
	EQUW	MATCH
	EQUW	RNUM
	EQUW	PSTOR
	EQUW	EXIT

;	$FIND

.LAF20	DEFWORD	"$FIND"
	EQUW	LAF08
.SFIND	EQUW	DOCOL
	EQUW	LIT,$3FF
	EQUW	RNUM
	EQUW	AT
	EQUW	LESS
	EQUW	ZBRAN,$12
	EQUW	TOPP
	EQUW	PAD
	EQUW	HERE
	EQUW	CSLL
	EQUW	ONEP
	EQUW	CMOVE
	EQUW	ZERO
	EQUW	ERROR
	EQUW	ONELIN
	EQUW	ZBRAN,$FFDE
	EQUW	EXIT

;	DELETE

.LAF50	DEFWORD	"DELETE"
	EQUW	LAF20
.DELETE	EQUW	DOCOL
	EQUW	TOR
	EQUW	LAG
	EQUW	PLUS
	EQUW	RAT
	EQUW	SUBB
	EQUW	LAG
	EQUW	RAT
	EQUW	NEGAT
	EQUW	RNUM
	EQUW	PSTOR
	EQUW	NLEAD
	EQUW	PLUS
	EQUW	SWAP
	EQUW	CMOVE
	EQUW	RFROM
	EQUW	BLANKS
	EQUW	UPDAT
	EQUW	EXIT

;	N

.LAF7F	DEFWORD	"N"
	EQUW	LAF50
.NN	EQUW	DOCOL
	EQUW	SFIND
	EQUW	ZERO
	EQUW	EMM
	EQUW	EXIT

;	F

.LAF8D	DEFWORD	"F"
	EQUW	LAF7F
.FF	EQUW	DOCOL
	EQUW	ONE
	EQUW	TEXT
	EQUW	NN
	EQUW	EXIT

;	B

.LAF9B	DEFWORD	"B"
	EQUW	LAF8D
.BB	EQUW	DOCOL
	EQUW	PAD
	EQUW	CAT
	EQUW	NEGAT
	EQUW	EMM
	EQUW	EXIT

;	X

.LAFAB	DEFWORD	"X"
	EQUW	LAF9B
.XX	EQUW	DOCOL
	EQUW	ONE
	EQUW	TEXT
	EQUW	SFIND
	EQUW	PAD
	EQUW	CAT
	EQUW	DELETE
	EQUW	ZERO
	EQUW	EMM
	EQUW	EXIT

;	TILL

.LAFC3	DEFWORD	"TILL"
	EQUW	LAFAB
.TILL	EQUW	DOCOL
	EQUW	NLEAD
	EQUW	PLUS
	EQUW	ONE
	EQUW	TEXT
	EQUW	ONELIN
	EQUW	ZEQU
	EQUW	ZERO
	EQUW	QERR
	EQUW	NLEAD
	EQUW	PLUS
	EQUW	SWAP
	EQUW	SUBB
	EQUW	DELETE
	EQUW	ZERO
	EQUW	EMM
	EQUW	EXIT

;	C

.LAFEC	DEFWORD	"C"
	EQUW	LAFC3
.CC	EQUW	DOCOL
	EQUW	ONE
	EQUW	TEXT
	EQUW	PAD
	EQUW	COUNT
	EQUW	LAG
	EQUW	ROT
	EQUW	OVER
	EQUW	MIN
	EQUW	TOR
	EQUW	RAT
	EQUW	RNUM
	EQUW	PSTOR
	EQUW	RAT
	EQUW	SUBB
	EQUW	TOR
	EQUW	DUPP
	EQUW	WBFR
	EQUW	RAT
	EQUW	CMOVE
	EQUW	WBFR
	EQUW	NLEAD
	EQUW	PLUS
	EQUW	RFROM
	EQUW	CMOVE
	EQUW	RFROM
	EQUW	CMOVE
	EQUW	UPDAT
	EQUW	ZERO
	EQUW	EMM
	EQUW	EXIT

;	<CMOVE

.LB02E	DEFWORD	"<CMOVE"
	EQUW	LAC9F
.CMOVU	EQUW	*+2
	LDA	#3
	JSR	SETUP
	LDA	N+1
	BMI	LB068
	CLC
	ADC	N+3
	STA	N+3
	LDA	N+1
	CLC
	ADC	N+5
	STA	N+5
	LDY	N

.LB050	TYA
	BNE	LB060
	LDA	N+1
	BNE	LB05A
	JMP	NEXT

.LB05A	DEC	N+1
	DEC	N+3
	DEC	N+5
.LB060	DEY
	LDA	(N+4),Y
	STA	(N+2),Y
	JMP	LB050

.LB068	JMP	NEXT

;	MOVE-BUFFERS

.LB06B	DEFWORD	"MOVE-BUFFERS"
	EQUW	LB02E
.MOVBUF	EQUW	DOCOL
	EQUW	LIMIT
	EQUW	TDUP
	EQUW	SUBB
	EQUW	QDUP
	EQUW	ZBRAN,$56
	EQUW	FIRST
	EQUW	OVER
	EQUW	PLUS
	EQUW	DUPP
	EQUW	HERE
	EQUW	ULESS
	EQUW	LIT,25
	EQUW	QERR
	EQUW	ROT
	EQUW	FIRST
	EQUW	SUBB
	EQUW	TOR
	EQUW	SWAP
	EQUW	DUPP
	EQUW	PREV
	EQUW	PSTOR
	EQUW	DUPP
	EQUW	USE
	EQUW	PSTOR
	EQUW	TOR
	EQUW	FIRST
	EQUW	OVER
	EQUW	LIT,FIRST+2
	EQUW	STORE
	EQUW	SWAP
	EQUW	RFROM
	EQUW	RFROM
	EQUW	SWAP
	EQUW	ZLESS
	EQUW	ZBRAN,8
	EQUW	CMOVE
	EQUW	BRAN,4
	EQUW	CMOVU
	EQUW	LIT,LIMIT+2
	EQUW	STORE
	EQUW	BRAN,4
	EQUW	TDROP
	EQUW	EXIT

;	PLOT

.LB0E0	DEFWORD	"PLOT"
	EQUW	LB06B
.PLOT	EQUW	DOCOL
	EQUW	LIT,$19
	EQUW	TOVDU
	EQUW	SWAP
	EQUW	ROT
	EQUW	TOVDU
	EQUW	DUPP
	EQUW	TOVDU
	EQUW	BSWAP
	EQUW	TOVDU
	EQUW	DUPP
	EQUW	TOVDU
	EQUW	BSWAP
	EQUW	TOVDU
	EQUW	EXIT

TOPNFA	=	*

;	$MSG

.LB107	DEFWORD	"$MSG"
	EQUW	LB0E0
.SMSG	EQUW	DOCOL
	EQUW	DUPP
	EQUW	DUPP
	EQUW	ZGREA
	EQUW	SWAP
	EQUW	LIT,26
	EQUW	LESS
	EQUW	ANDD
	EQUW	ZBRAN,$20
	EQUW	LIT,LB47E
	EQUW	SWAP
	EQUW	ZERO
	EQUW	XDO
	EQUW	DUPP
	EQUW	CAT
	EQUW	PLUS
	EQUW	ONEP
	EQUW	XLOOP,$FFF6
	EQUW	COUNT
	EQUW	TYPE
	EQUW	BRAN,4
	EQUW	MSGNUM
	EQUW	EXIT

IF REMOVE_UNREACHABLES=FALSE

;	MM

.LB146	DEFWORD	"MM"
	EQUW	LB107
.MM	EQUW	DOCOL
	EQUW	TWOP
	EQUW	SWAP
	EQUW	DUPP
	EQUW	ROT
	EQUW	DUPP
	EQUW	ROT
	EQUW	OVER
	EQUW	CAT
	EQUW	ONEP
	EQUW	CMOVE
	EQUW	CAT
	EQUW	ONEP
	EQUW	PLUS
	EQUW	EXIT

;	M1

.LB169	DEFWORD	"M1"
	EQUW	LB146
.M1	EQUW	DOCOL
	EQUW	PDOTQ
	EQUB	11,"Stack empty"
	EQUW	EXIT

;	M2

.LB180	DEFWORD	"M2"
	EQUW	LB169
.M2	EQUW	DOCOL
	EQUW	PDOTQ
	EQUB	15,"Dictionary full"
	EQUW	EXIT

;	M3

.LB19B	DEFWORD	"M3"
	EQUW	LB180
.M3	EQUW	DOCOL
	EQUW	PDOTQ
	EQUB	26,"Has incorrect address mode"
	EQUW	EXIT

;	M4

.LB1C1	DEFWORD	"M4"
	EQUW	LB19B
.M4	EQUW	DOCOL
	EQUW	PDOTQ
	EQUB	12,"Isn't unique"
	EQUW	EXIT

;	M5

.LB1D9	DEFWORD	"M5"
	EQUW	LB1C1
.M5	EQUW	DOCOL
	EQUW	PDOTQ
	EQUB	29,"Parameter outside valid range"
	EQUW	EXIT

;	M6

.LB202	DEFWORD	"M6"
	EQUW	LB1D9
.M6	EQUW	DOCOL
	EQUW	PDOTQ
	EQUB	26,"Screen number out of range"
	EQUW	EXIT

;	M7

.LB228	DEFWORD	"M7"
	EQUW	LB202
.M7	EQUW	DOCOL
	EQUW	PDOTQ
	EQUB	10,"Stack full"
	EQUW	EXIT

;	M8

.LB23E	DEFWORD	"M8"
	EQUW	LB228
.M8	EQUW	DOCOL
	EQUW	PDOTQ
	EQUB	25,"Can't open or extend file"
	EQUW	EXIT

;	M9

.LB263	DEFWORD	"M9"
	EQUW	LB23E
.M9	EQUW	DOCOL
	EQUW	PDOTQ
	EQUB	24,"Read/Write not completed"
	EQUW	EXIT

;	M10

.LB287	DEFWORD	"M10"
	EQUW	LB263
.M10	EQUW	DOCOL
	EQUW	PDOTQ
	EQUB	26,"Can't redefine end-of-line"
	EQUW	EXIT

;	M11

.LB2AE	DEFWORD	"M11"
	EQUW	LB287
.M11	EQUW	DOCOL
	EQUW	PDOTQ
	EQUB	20,"Can't divide by zero"
	EQUW	EXIT

;	M12

.LB2CF	DEFWORD	"M12"
	EQUW	LB2AE
.M12	EQUW	DOCOL
	EQUW	PDOTQ
	EQUB	26,"Undefined execution vector"
	EQUW	EXIT

;	M13

.LB2F6	DEFWORD	"M13"
	EQUW	LB2CF
.M13	EQUW	DOCOL
	EQUW	PDOTQ
	EQUB	15,"Branch too long"
	EQUW	EXIT

;	M14

.LB312	DEFWORD	"M14"
	EQUW	LB2F6
.M14	EQUW	DOCOL
	EQUW	PDOTQ
	EQUB	28,"Incorrect CURRENT vocabulary"
	EQUW	EXIT

;	M15

.LB33B	DEFWORD	"M15"
	EQUW	LB312
.M15	EQUW	DOCOL
	EQUW	PDOTQ
	EQUB	1,' '
	EQUW	EXIT

;	M16

.LB349	DEFWORD	"M16"
	EQUW	LB33B
.M16	EQUW	DOCOL
	EQUW	PDOTQ
	EQUB	1,' '
	EQUW	EXIT

;	M17

.LB357	DEFWORD	"M17"
	EQUW	LB349
.M17	EQUW	DOCOL
	EQUW	PDOTQ
	EQUB	16,"Compilation only"
	EQUW	EXIT

;	M18

.LB374	DEFWORD	"M18"
	EQUW	LB357
.M18	EQUW	DOCOL
	EQUW	PDOTQ
	EQUB	14,"Execution only"
	EQUW	EXIT

;	M19

.LB38F	DEFWORD	"M19"
	EQUW	LB374
.M19	EQUW	DOCOL
	EQUW	PDOTQ
	EQUB	23,"Conditionals not paired"
	EQUW	EXIT

;	M20

.LB3B3	DEFWORD	"M20"
	EQUW	LB38F
.M20	EQUW	DOCOL
	EQUW	PDOTQ
	EQUB	23,"Definition not finished"
	EQUW	EXIT

;	M21

.LB3D7	DEFWORD	"M21"
	EQUW	LB3B3
.M21	EQUW	DOCOL
	EQUW	PDOTQ
	EQUB	23,"In protected dictionary"
	EQUW	EXIT

;	M22

.LB3FB	DEFWORD	"M22"
	EQUW	LB3D7
.M22	EQUW	DOCOL
	EQUW	PDOTQ
	EQUB	21,"Use only when LOADing"
	EQUW	EXIT

;	M23

.LB41D	DEFWORD	"M23"
	EQUW	LB3FB
.M23	EQUW	DOCOL
	EQUW	PDOTQ
	EQUB	26,"Off current editing screen"
	EQUW	EXIT

;	M24

.LB444	DEFWORD	"M24"
	EQUW	LB41D
.M24	EQUW	DOCOL
	EQUW	PDOTQ
	EQUB	25,"NOT in CURRENT vocabulary"
	EQUW	EXIT

;	M25

.LB46A	DEFWORD	"M25"
	EQUW	LB444
.M25	EQUW	DOCOL
	EQUW	PDOTQ
	EQUB	7,"No room"
	EQUW	EXIT

ENDIF

.LB47E	EQUW	1
	EQUB	11,"Stack empty"
	EQUB	15,"Dictionary full"
	EQUB	26,"Has incorrect address mode"
	EQUB	12,"Isn't unique"
	EQUB	29,"Parameter outside valid range"
	EQUB	26,"Screen number out of range"
	EQUB	10,"Stack full"
	EQUB	25,"Can't open or extend file"
	EQUB	24,"Read/Write not completed"
	EQUB	26,"Can't redefine end-of-line"
	EQUB	20,"Can't divide by zero"
	EQUB	26,"Undefined execution vector"
	EQUB	15,"Branch too long"
	EQUB	28,"Incorrect CURRENT vocabulary"
	EQUB	1,' '
	EQUB	1,' '
	EQUB	16,"Compilation only"
	EQUB	14,"Execution only"
	EQUB	23,"Conditionals not paired"
	EQUB	23,"Definition not finished"
	EQUB	23,"In protected dictionary"
	EQUB	21,"Use only when LOADing"
	EQUB	26,"Off current editing screen"
	EQUB	25,"NOT in CURRENT vocabulary"
	EQUB	7,"No room"

TOPDP	=	*	; TOP OF DICTIONARY

FOR n,TOPDP,$BFFF

	EQUB	$FF

NEXT

	PRINT	"ROM bytes free: ",$C000-TOPDP
	SAVE	"forth-assembled.rom",L8000,*
